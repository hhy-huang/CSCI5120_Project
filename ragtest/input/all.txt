[ARTICLE 1: 以太坊深度研究：增长的垄断]
## Pitch
### 一家优质的公司
以太坊有点像一家拥有双赢生态体系的优质“公司”，但交易的估值却相对悲观。公司具有很强的弹性，具有相当大的选择余地，而随着以太坊在 8 月和 12 月/2022 年初进行分叉，以太坊会出一种“特殊情况”，预期会有上行的波动性。
简单介绍一下（稍后我们还会回顾基础知识），以太坊是支撑去中心化金融 ( DeFi ) 运动的基础协议。通过DeFi，用户可以在没有银行等第三方的情况下进行点对点交易。以太坊还是非同质化代币 (NFT) 运动以及去中心化自治组织运动（DAO）的基础——前者为艺术品和证书等东西创造字稀缺性，后者则可以用新的方式组团来实现某些预设目标。
达成共识了吗？很好。回到我们的pitch。
质量是个主观指标。通常一致的要求是管理人员有才能、单位经济有利，以及相对于竞争对手有可持续优势。如果公司在的产品有可证明的创新，并能够不断适应以找到最佳产品市场匹配的话，那就更好了。
在大型科技公司公布财报后，我看到了几条关于“增加规模回报”以及“好公司如何意外向上”的推文。希望这篇文章能让你相信，就像任何一家优秀公司一样，以太坊在这个规模优势的世界里活得很好，而且在历史上（往往）会出人意料地走势向上。
尽管Vitalik Buterin是以太坊的创始人和代言人，但它的核心开发团队散布在世界各地。我认识的一些最聪明、动力最足的人现在正在从事加密货币的工作。
这家“公司”还有着类似平台的单位经济，具备超精益的成本结构（在权益证明合并后），其中大多数的参与者都是深受激励的业主经营者。优质公司的关键区别之一是双赢的生态体系。以太币与共享规模经济平台的活力都意味着以太坊是目前最不零和的生态体系之一。
由于运营成本收入比要比传统银行低 20 倍左右，以太坊较低的遗留成本意味着可以将节省下来的大量成本让渡给最终用户。此外，由于用户和开发者通常自己也持有以太币，所以会像股东一样积累价值。这就像 AWS，但使用的支付和获得报酬都是以Amazon股票的形式。
跟很多的互联网公司相比，以太坊的抽佣率要低得多（而且还在下降），增长速度是后者的数倍，而且是用类似的远期市销率进行交易，其 PEG 为 0.03，相比之下，软件/金融平均水平约为2.5。
大约 80% 的去中心化app ( dApps ) 都是基于以太坊协议开发的，所有这些app都是为了可互操作而开发。这些的dApp开发得越多，其交互性就越强，以太坊的网络就愈发的根深蒂固。再加上以太坊开发者有着升级产品的多年履历，以及非以太坊开发者在该协议上进行的大量创新，一个高度适应性的生态体系就出现了。
在希腊神话里，赫拉克勒斯降伏并斩杀九头蛇。这个怪物每掉一颗脑袋就会在同样位置上长出两个。九头蛇是一种完反脆弱动物。每一次被破坏，它都会变得更加危险。跟九头蛇一样，以太坊协议已被证明具有高度的反脆弱性。每次协议被黑客攻击、bug被暴露或某个dApp出问题时，都会有更多的同类在同样位置上长出来。
以太坊的创新、反脆弱性以及广泛的网络效应是其在未来dApp开发当中的可选性的基础。它的产品优于其他区块链同行以及传统金融，跟计算提供商的竞争日益激烈。这是它的韧性基础。
作为一项技术，以太坊面临着来自 Terra、DFINITY、Binance Smart Chain、Polkadot 、Cardano等公司的激烈竞争。每个竞争对手通常都会有一两件事情做得比以太坊更（一般是交易成本更低或每秒交易量更高）。这些团队都在快速成长、具有高度创新性、都很积极进取，资金都很充裕。但都没有规模跟以太坊接近的网络。这些协议的技术优势通常是特定流程中心化的结果，但确实建立在一个采用率要低得多的基础之上，而且（其中一些）节点成本要高得多。考虑到网络效应以及在后者平台上目前的创新数量，这些协议取代以太坊的可能性很低，而以太坊则通过Layer 2解决方案继续降低成本、降低抽佣率，提高吞吐量的趋势的可能性仍将继续。
那么它跟非区块链替代品相比又如何呢？稍后我会介绍去中心化、P2P、超健全货币（ultra sound money）模因以及DeFi 、NFT、DAO 与其他dApp所带来的增值。不过，有个大问题以太坊需要面对，那就是它在跟链下支付基础设施和链下计算提供商的竞争当中的扩展能力。
就目前而言，还不是很好。高昂的矿工费阻止了频繁交易与复杂代码。为了让以太坊可行，吞吐量需要提高，交易成本需要能跟其他的软件开发平台竞争。除此之外，去中心化以及安全性只是一堆功能需求当中的两个。蓬勃发展的数字经济还有很多其他同样重要的需求（易用性、与现实世界的集成、效用成本平台、稳定性、可预测性、国家的采用等）。虽然以太坊正在迅速获得这些特性，但这些东西现有的替代品已经有了。非加密原生采用很大一部分要取决于以太坊在这些因素上的竞争力，而不是它的去中心化或安全性。
长话短说：以太坊2.0的推出和正在开发的扩展解决方案可让以太坊在未来 12-18 个月内达到具有竞争力的水平。在互操作性上，以及当交易需要绝对的有效性（比方说用于支付和价值转移）时的每笔交易成本方面，以太坊目前胜过所有的替代方案。
大家可能愿意为去中心化和数据隐私支付溢价，但即便采用Eth2.0 及扩展解决方案，成本仍然比中心化的链下计算替代方案贵 10 倍左右。也许未来的扩展能解决这个问题。值得注意的是，作为存储平台以太坊也许永远都不会有竞争力。可能有朝一日它会通过将存储外包给侧链来竞争，但目前这只是猜测。
本文后续将详细介绍上面概述的大部分内容。不过，在我看来，很多投资者一直用来把以太坊当作一种年轻的比特币，跟其他的“加密货币垃圾”混为一谈，这种心智模式是错误的。到目前为止，我已经提出了一种二级模型，也就是把以太坊当作一家公司看待。不过，就算这样也不算公正。
David Hoffman在《A New Model For Money》一文中论证了以太币是一种“三重点资产”（triple point asset），可同时用作消耗品（如石油）、资本资产（股票）以及价值储存（黄金）。正是这种定位促成了ETH的第二种特殊情况：ETH会受到供应紧缩前所未有的打击。
## 特殊情况
以下是 以太坊协议的关键分叉。August分叉（EIP1559）又叫“伦敦”硬分叉，而权益证明就是“合并”。预计两者都将显著提高交易成本并减少供应。
简而言之，供应紧缩的基础来自 EIP1559 与权益证明（ PoS ）合并的叠加。在基于权益的链上，会出现：
- 矿工卖压降低（估计约为 22 300 ETH/天），因为矿工不再需要验证交易，也不再需要收回能耗成本，
- 加上gas费导致的供应量下降（每年约 2%），
- 及供应的结构性流出，因为越来越多的以太币持有者为了收益而质押手头的以太币（从质押的占比目前的约 12%变成合并后的 30% 以上）。
预计抛售压力将降至约 2600 ETH/日，比当前水平下降了约 90%。再加上（由于结构性抵押/ DeFi供应流出导致）浮动减少，以太币变得更加并不稳定几乎不可避免。为什么这种波动可能会导致上行呢？因为：
- 当抛压下降时，当前的需求压力可能会超过未来的卖出压力。
- 需求缺乏弹性来自即将推出的 ETF 的被动流入。
- 价格上涨导致零售叙事采用“互联网货币”+ 权益收益。
- 零售入口越来越多（Visa、PayPal）。
- 机构已经熟悉 BTC。
两点补遗：像 Lido 这样的团体促进了质押ETH 的流动衍生品市场的创建（你给Lido以太币，对方然后拿去质押，再铸造stETH 代币，你可以用DeFi协议交易或锁定你的stETH ）。这样又可以质押更多的 ETH，同时让那些希望将自己质押的ETH 进行货币化的人不需要取消质押资产就能这么做。这还使得质押ETH 变得容易很多。
快速深入了解一下机制：因为取代了矿工，协议会授予质押的 ETH一定收益——因为后者通过验证交易并“质押”自己的以太币确保了协议的安全。这种收益率意味着质押的ETH（或stETH ）比未质押的ETH更有价值，因为它本质上是 ETH + 资本收益。
这些衍生品之间的相互作用意味着存在套利机会，从而确保 ETH 和stETH永远不会偏离其相对价值太远。然而，stETH提供收益这一事实意味着大多数理性的参与者会把自己的 ETH换成 stETH ，然后交换/出售/锁定该stETH以获得收益。这里的激励机制很可能导致原始stETH收益率（由 Lido/以太坊协议提供）逐步趋于下降。质押收益率<2%就是最低了，只有当 90% 的 ETH 都被质押时才会出现这种情况。
ETH / stETH这种动态的好处意味着以往被排除在非流动性情况之外的机构可以利用 ETH。这也意味着需要流动性的人现在没理由不质押自己的 ETH。结果呢？会有更多的 ETH被质押。
补充：如想知道所有这些类似庞氏骗局的收益从哪儿来，它实际上只是向常规市场提供流动性所创造的常规价值。只是，现在这算在用户头上，而不是被银行系统的遗留成本所吸收。
然后就是Pitch 的最后一部分，也就是估值，你会发现 很难给ETH估值。分析师估计的范围从5 700 美元/ETH（用比特币普及的stock-to-flow模型）到超过 150000 美元/ETH不等。
## 基础知识
要想理解以太坊，你首先得理解去中心化计算以及比特币的创建目的。去中心化计算的大概定义是这样一种计算机应用，它可以为其用户制造出一些有用的结果，它可以在世界各地的多台计算机上同时运行，而不仅仅是在一台中央服务器上运行，而且连接这些计算机的网络可以协同工作，不需要信任任何一台计算机或其管理员是否诚实。
比特币是第一个成功的去中心化应用。比特币内嵌了三大核心创新：
- 点对点网络。不过这并不新鲜——之前就有BitTorrent，
- 区块链。一种相当新颖的数据存储方式（是比较新，但不算革命性），
- 共识机制。这个改变了游戏规则。比特币依赖工作量证明系统，联网计算机靠这种机制同意并记录共享数据集的更改。
正是工作量证明共识机制让比特币确保在整个区块链上达成一致：由于矿工必须支付能耗成本，所以他们不会浪费能耗去验证别人不会同意的交易。拥有最多验证的链被定义为最长的链。每一链接的区块代表为验证这些交易所做的工作。最长的链是合法性最强的，这样就通过工作量证明达成一致。
去中心化计算是由中本聪设计的，旨在解决互联网的价值转移层问题。2008 年之后，中本聪认为当前的价值传输协议需要受信任的第三方身份验证，从而产生不必要的费用，没法支撑互联网时代的交易。所以，比特币一开始是数字化的点对点现金。然而，这一协议作为身份验证机制，规模翻了一番，尽管它验证的只是bitcoin的身份（小写的“b”，比特币协议的输出和交换媒介）。
正是这第二种机制——对透明、公有身份的数据进行验证的能力——已经成为第二代区块链（以太坊是其中最重要的一种）的重点。目前，区块链技术的主要用例是投机。下一个主要用例是价值存储——大家分别“健全货币”模因和“超声波货币”模因来为比特币和以太坊发声。越来越多的人认为加密货币比黄金或法币有更好的价值主张。
在意识形态上，比特币人倾向于自由主义，拥护米塞斯、罗斯巴德、斯皮茨纳格尔和哈耶克。其信念从根本上认为去中心化可以实现政治中立的个人主权，这是一项值得去实现的追求。他们往往认为比特币的简单性是其最大的优点。使其在存储和转移价值方面更胜一筹，除此之外别无他物。基础层在设计上做到了极简化，访问运行节点的门槛较低，宁愿通过闪电网络这样的第 2 层进行扩展。因此，比特币的路径依赖，安全，去中心化以及作为加密货币的林迪效应令其成为加密货币当中最好的一个（也是唯一的一个，如果你是极多主义者的话）。然而，抛开数字现金/价值存储之争不管，去中心化计算的边缘用例就包括了逐步取代传统金融系统的DeFi，以及围绕数字稀缺商品不断发展的社区——NFT。这些几乎完全是建立在以太坊之上的。
跟比特币一样，以太坊也是一个开源网络，旨在对交易进行验证。跟比特币不一样的是，以太坊是完备的。这意味着，比特币协议的全部意义在于验证比特币的转让，以及产生一点点比特奖励那些验证者，而以太坊的意义则要广泛得多。以太坊是为了让大家可以在它的基础上开发，而且能够验证任何类型的交易或交易集（所谓的智能合约）。它是可编程的。如果说比特币是HP-35的话，那以太坊就是微软的Excel。Excel只是理解以太坊的几个有用的类比之一。以太坊还类似：一堆分布式的在线自动售货机，数字石油，公有的AWS，Web3.0的TCP/IP等。
那么以太坊是怎么运作的呢？在谈这个之前，我们先得拆解一下智能合约。智能合约是支持以太坊生态体系的自动执行的不可变的协议。可将它们视为一堆If-Then指令。开发者用以太坊的编程语言（Solidity）编写智能合约并将其上传到以太坊系统（以太坊虚拟机）。将该应用当作验证者（称为“节点”）运行的每个人都将获得该代码的副本。当用户用这些合约进行交易时，所有节点都必须根据合约规则验证结果。这个验证过程就是区块链所依赖的计算。
每一位矿工会不断地验证交易块。合法的块会被添加到链上。“链”是所有交易和智能合约的历史（和当前状态）。为了阻止大家对计算系统进行超频，用户必须支付矿工费（gas fee）作为计算信用。Gas是用以太币（Ether，也叫做ETH）购买的。在Eth1.0下，用户为了求验证，或者优先处理自己的交易，会支付给矿工gas费或者协议发行的ETH。在Eth2.0下，这些gas费会被烧掉（就像股票回购），而小费会累计给质押ETH的人。
以太坊的货币政策这个话题很复杂，之前就已经硬分叉（“变更”的加密货币术语）过大约10次了。目前，发行/通胀率约为0.2%。这些新铸造的ETH会提供给矿工。在伦敦分叉（EIP1559）以及Eth2.0推出后，发行率会由一个Staked Ether/Total Ether算法确定，一边需要有更高的质押收益率（发行率）时激励增加的安全性。从理论上来说，其净效应会是一个基于规则的、通货紧缩的、增强吞吐量的政策。
“如果加密货币技术成功的话，并不是因为它为更好的人赋权。而因为它为更好的机构赋权。”以太坊创始人Vitalik Buterin说过的这段话我很喜欢。以太坊的可编程性是它的决定性特征。跟比特币相比，它的交易更快、更便宜，而且它的网络比其他替代品更安全，更加去中心化。以太坊非常节能，在过去24个月的时间里出现了大量的创新，并且在此基础上开发出大量应用——包括多个央行的应用。但是，你也可以说AWS也能满足其中的大部分要求。AWS很稳定，延迟最小，创新活跃，数据交易便宜且丰富。区别在哪里？AWS不是去中心化的。而且AWS不能像以太坊那样调节激励措施。
由于gas费必须用ETH支付，开发者和用户都必须拥有ETH。这意味着他们会受益于代币的升值。除此以外，这也意味着ETH的价值越高，网络就越难攻击。虽然实际上没有开发者会认为“让我持有ETH，这样项目就是安全的”，但他们几乎肯定会认同“鼓励大家研究在以太坊上开发dApps，好让生态体系发展”。对于每一个建立在以太坊基础上的dApp来说，支付的gas费越多，开发的互操作性越高，网络就越安全，从而提高在以太坊上面开发的吸引力。这就是以太坊协议核心的正反馈循环。
但是，如果太多团队加入得太快，gas费就会飙升，从而阻止过度采用。这种负反馈循环控制着协议，因为过度采用可能会导致快速发布的代码出现同样的激增，充斥着bug和糟糕的用户体验，挤压了更有用、更有弹性的dApp稀缺的网络空间。这些正负反馈循环共同控制着生态系统的发展以及价值增长的轨迹。从历史上看，我们在应用/平台级（如Google/Maps）看到的价值创造远远超过了基础设施级（HTML/GPS）。我刚刚概述的确保以太坊协议始终必须比在它之上开发的dApp更有价值这一点，是为了避免协议遭受纯粹是为了掠夺dApp价值的51%攻击。
除了作为gas费以及质押抵押资产之外，ETH在DeFi中还可用作储备资产、抵押品、融资以及交换媒介。有些零售商接受ETH，而ETH是数字稀缺商品（NFT/链上游戏内物品）的默认记账单位。所有这些意味着ETH目前是一种高度可交易的资产，跟主要就是为了持有的比特币不同。
大家愿不愿意交易快速升值的代币很让人好奇。在BTC的情况下，文化已经决定“不”。除非我们把新的金融体系货币化了。在ETH的情况下，大家的态度似乎在往“是”。如果我们相信所买的东西比代币更有价值的话。但是，他们目前购买的（NFT、DAO治理代币、DeFi掉期等）都陷入到ETH越贵NFT就越贵的之中，并且都通过生态体系的发展以及gas费需求推高了ETH的价格。
上图可能意味着以下几点中的一个。这可能意味着ETH愈发被持有者看作是一种价值储存手段或投机工具。这可能意味着更多的用户在中心化的交易所交易。或者这可能只是意味着这些年来很多人清空了自己的ETH账户，只留下一堆未使用的钱包。可是，看到自2017年初以来唯一地址的数量增加了近40倍之后，你很难得出结论说以太坊的网络没有增长。
我尤其喜欢Allen Farrington提出的那个问题：“如果一个全球性的、数字化的、健全的、开源的、可编程的货币似乎是从绝对的零开始货币化的话，那（最后）它会是什么样的？”我也会问类似的问题，如果一个完整的金融生态体系死从零开始货币化的话，最后会变成什么样子。让ETH数量上升的价值流动在我看来很有意义：
- 以太坊生态体系发展→更多的交易→gas费的需求增加→对ETH的需求增加。
- 采用以太币（或以太坊上的BTC）作为货币/价值存储→对ETH的需求增加。
- 用户质押ETH→减少供应。
- 用户质押ETH→减少供应。
- 质押的ETH产生收益，因为这是参股以太坊网络，是对以太坊收取费用的声索→更多的人买入ETH来质押。
不太清楚的是这项技术在现实世界的用例是什么。乔布斯一次在接受采访时曾说过一段很经典的话：“......你必须从用户体验出发，然后看有什么技术可以采用。而不是从技术出发，再想办法弄清楚把它卖给谁。”对以太坊最大的谜题就是：用户体验虽然有所改善，但还是很粗劣。我妈永远不会在币安完成KYC（身份验证），打开MetaMask钱包，把自己在币安买的一些ETH发往该钱包，再将ETH质押到Lido，然后开始到Curve上进行流动性挖矿。她不想知道gas费、库存流量比（stock-to-flow）或协议这些东西。作为技术这些东西令人兴奋，但用例远不是以客户为中心，距离主流采用还有很长的路要走。
## DeFi、NFT与DAO
“以太坊的生态体系必须扩大，不能光是做自己买进卖出的代币。”——Vitalik的又妙语。目前的情况是，大量的加密货币都掌握在那些交易者手上，纯粹是为了零和投机以及货币间套利而交易代币。按美元交易额计算，DeFi占到了生态体系价值的99%。可是，从交易数来看，游戏占了81%。同样地，NFT被指责是投机性的艺术泡沫，2021年围绕着加密货币的大部分媒体焦点都集中在这些看起来很怪异的数字化图片上。
DeFi、NFT、DAO，这些都是去中心化应用(dApps)的典型用例。DEFI这个生态体系由金融类dApp组成，NFT是上链的一连串代码，可通过dApp被购买、出售、铸造及拥有，DAO是通常由dApp管理，通过dApp操作与交互的组织。dApp本质上是一组智能合约，目前仅限于相对简单的用例（更复杂的代码与计算产生的高昂gas费的结构性结果）。
可以说这是分布式计算的关键限制：根据定义，由于这种状态管理系统相对于集中式系统要出现在更多的地方，其计算成本更高是不可避免的。由于dApp在链上执行的每个操作（铸造NFT、交易、接口）都会产生gas费，所以计算成本会随着代码复杂度的提高呈指数增长。
这个问题在以太坊社区已是众所周知的。最终，社区似乎选择遵循了通过技术解决方案扩展的做法，针对去中心化、可编程性及互操作性来优化而不是降低费用。其根本原因是前者要么在基础层面去做，要么就不存在。那费用高的问题怎么解决？通过供需机制改进技术第二层的构建块并降低交易费用，让它们变得像汽车的汽油一样可以忽略不计。
加密货币爱好者会告诉你，DeFi有朝一日也许可以让大家支付、汇款、买卖东西、申请贷款和抵押贷款、为初创企业众筹，以及现有的金融系统所能做到的一切。NFT理论上会让所有认证上链。从数字化身份证、地契、国家文件、跨游戏数字商品和知识产权保护到安全基础设施、数据存储、供应链优化以及独立社交媒体，加密货币仿佛能带给我们香格里拉式的希望。尽管这一切皆有可能，但最好用客观性对冲一下这种希望。
### DeFi
去中心化金融（DeFi）是一个尚在发展中的金融dApp生态体系，目标是用不依赖银行等可信中介的金融系统来取代现有的金融系统。一个常见的加密货币模因认为，DeFi就是将金融系统的各个部分组合在一起的货币乐高积木。
大概有80%的DeFi发生在以太坊区块链上，而且用ETH作为储备资产。其核心机制是用户必须将ETH和其他资产锁定在流动性池里面，这样才能为这个生态体系提供流动性。如果想用一种代币交换另一种代币，你得把自己的ETH放进池子里面，然后才能取出另一种代币。因为这种交换的特权，他们需支付费用。收取的费用归流动性提供者所有。
因为喜欢某个项目在做的事，并且希望在该项目的治理中有一些发言权（这些项目就是所谓的DAO，DAO由代币持有者用类似上市公司和股东的方式进行管理），有时大家可能会想要一种ETH以外的代币。有的时候，他们想要另一种代币纯粹是因为觉得可以到其他地方去交易来获利。虽然这一切似乎很投机，但要记住的是，这跟大银行处理债务和衍生品的一般方式很相似。
在DeFi中锁定某个东西跟质押你的ETH来保护以太坊协议不一样。ETH质押利率为DeFi提供了“无风险利率”。DeFi锁定的ETH越多，以太坊协议就越认识到对安全的需求（质押的价值/总价值之比），然后提高ETH质押利率。反之亦然。质押的ETH越多，DeFi的流动性成本就越高，大家进而愿意支付更高的费用并提高流动性池的收益率。
Alden和Pfeffer质疑以太坊协议的采用会不会导致ETH代币升值。由于DeFi采用了ETH（协议与/或资产），因此代币（LP或ETH）的提供既是在链上进行交易的（会产生gas费），又会减少质押的ETH（导致ETH质押利率上升）。其净效应是增加对ETH的需求（除了增加费用以外），就像国债收益率上升会吸引投资者一样。如果这些投资者从DeFi撤出（不太可能，因为那里的收益率更好），那么协议的净效应将会是减少对ETH的需求，从而降低ETH的价格。不过，这种情况发生的可能性很小。### DeFi 的潜力与挑战
采用加密货币不一定就会导致 ETH 升值。如果它们是从外部加密货币拉过来的话，那 ETH 更有可能会升值，因为这种采用不是零和。那么，DeFi 提供的东西里面哪些是传统世界所没有的？
首先，这是无需许可的。从理论上来说，这意味着贝索斯跟开普敦的无家可归者之间没有区别。因为没有 KYC（身份验证）/AML（反洗钱），所以对谁可以参与是没有限制的。在实践上，这意味着你目前需要有可用的互联网连接，有时间并愿意花一周或更长时间去熟悉各种风险、平台与项目，而且你要有足够的资金，以免几次交换尝试不会花光你一生的积蓄。这对发达世界有利，但对于“无银行账户”来说仍然是进行时。
理论上，自我托管和控制也可以分散系统性故障的影响（像2008年或 LTCM 那种崩盘）。“不掌握私钥，就不是你的币。”这句话在加密货币圈广为人知，但实际上，非加密原生的家伙里面没多少人愿意考虑托管。比如说，他们宁愿把钱存进安全的银行。加密货币要想进入主流，需要摆脱“我们会被黑掉，确保自己”的耻辱，提供更好的用户体验，让非托管技术（用户完全控制自己的钱包和数字资产）站稳脚跟。
第三，可互操作性。虽然我妈妈也许不愿意，但我却敢把自己的 ETH 质押到 Lido 上面，把 stETH 锁定到 Curve 流动性池里面，然后把我的流动性代币（让我收回自己的 stETH 的东西）当作 MakerDAO 的抵押品，然后到 Axie Infinity（一款上链的游戏，玩了可以得 AXS）上面买点动物。而 AXS 可以兑换 ETH。这个循环又开始了。
如果你觉得这一切很疯狂的话，那你并不孤单。从目前来看，这种互操作性看起来有点像个噱头，像庞氏骗局，但这种开放平台能带来什么样的创新并不需要你太多的想象力。
DeFi 本质上收益也更高。目前的说法是“早期采用者才有高收益”。虽然蓝筹代币两位数的高收益不太可能可持续，但用户不应被传统金融的非加密货币收益所束缚，因为传统金融得填补遗留成本和寻租。无需许可和互操作性的结合意味着新的商业模式、金融产品和工作方式可能会有若干的机会。
就像 Hydra 以及类似 AWS 但用亚马逊股票支付的类比所展现那样，DeFi 还具有高度的反脆弱性，而且激励更为一致。最近几个月，稳定币（支持更多现实世界的接口）在监管方面已经取得进展，并正在推动采用。最后，这个生态体系正在涌入资金与人才，开发者跟用户也是动力十足，最近几个季度风投也在激增。
从经济上讲，现金过剩意味着分配给该行业的增量资本的投资回报率低于替代品。本文要讨论的不是任何特定项目的资金分配问题——很多加密货币初创企业的估值都很高。但是，由于大部分价值都是在协议这一级捕获的，而且由于 DeFi 给增长留出的 runway 很长，以太坊仍然是对该行业指数化的一个投资回报率很高的赌注。
当前对 DeFi 的担忧有两个原因，一是现实世界的用例有限，二是很多 dApp 都是中心化的（很讽刺吧？）。很多 dApp 都要依赖第三方的节点聚合器（如 Infura），后者往往又要通过 AWS 等现有的云服务器才能跑这些节点。这是因为维系一个交易节点所要消耗的时间、金钱和存储成本对于小型开发者来说可能太高了。这些阻塞点是生态体系的漏洞。
说到实际用例，目前的主要用例是 yield farming（加密货币投资者将资金投入到不同 DeFi 协议中来赚取最大回报）与规避 KYC。在现实世界的其他用例（如保险、抵押贷款、稳定存款、无抵押贷款等）应该会慢慢出现。不过，里面很多都需要某种形式的数字身份（如 DID），并且可能需要跟现有的法律体系同步。与此同时，改进新用户引导流程的用户体验以及针对代码错误与管理员密钥丢失开发解决方案也会很有帮助。
### NFT 与 DAO
非同质化代币 (NFT) 是将数字资产代币化到区块链上——从而让以前可复制的东西变得稀缺。如果 DeFi 是货币的乐高积木的话，那 NFT 就是媒体的乐高积木。当前的大部分用例都是游戏内物品和数字艺术，但有很多初创企业正在把注意力聚焦到所有权证书和 ID 等合法物品的代币化上。从法律上来说，NFT 充其量只是一个灰色地带——一个人真的可以拥有某个历史事件的快照吗？然而，随着元宇宙以及创作者经济等概念在搜索趋势上日趋火爆，法律可能很快就会迎头赶上。
在过去一年的时间里，NFT 的采用率出现了猛增。撇开未来的投机用例不谈，现在 NFT 为创作者从根本上提供了更好的经济效益。在 2008 年的那篇经典的《一千位真正的粉丝》（A Thousand True Fans）里，凯文·凯利讲述了为什么互联网会为创作者改变格局：互联网可以让他们在自己的粉丝群里面找到最忠实的一批粉丝，进行货币化并跟他们建立联系，而用不着吸引所有的受众——因为当中的很多人其实只有一点点兴趣。虽然凯利的部分愿景是在社交媒体以及 Instagram 名人身上得以实现，但货币化一般都只是靠笨拙的广告，赞助效率低下。NFT 在创作者领域之所以如此火爆，原因之一是因为 NFT 让创作者可以专注于肥尾。
虽然数字资产一般都可下载，但这并不会损害 NFT 的价值。就以照片为例吧：就像模因之所以成为模因只是因为很多人都知道它一样，知道原创的人越多，你的所有权就越有价值。跟音乐行业的自听歌不同，艺术的大部分乐趣来自拥有。NFT 目前正是因为拥有这种乐趣以及可以转售的能力。
虽然很多 NFT 的创作者和购买者都是加密货币原生的，但像 Momint 这样的公司正在让创作者不需要了解后端就能铸造、购买和展示 NFT。这是让 NFT 进入主流的关键一步。此处的重点是良好的用户体验、免费以及通过非加密货币网红和名人吸引更广泛的粉丝群。
NFT 还有两个好处：一是支持细颗粒度的定价，而且（跟 DeFi 一样）干掉了中介与传统分销商的寻租行为，这往往会此生大量的遗留成本。其结果是留给创作者的钱更多了，粉丝掌握的所有权更多了。创作者可以独立给 NFT 定价，用不同的价格和不同的媒介销售原版、限量版以及其他的副本。他们可能不再需要赞助，或者依赖类似 Patreon 这样的支持，从而打开了新的商业模式的可能性。其中一种模式是销售 NFT 产生的版税，按照未来销售或类似 NFT 衍生销售的百分比来计算。
那 DAO 呢？这个东西就有点复杂了——基本上，DAO 是由算法控制的，聚在一起以实现特定目标或目标集的利益相关者群体。组织的规则在区块链上设定，智能合约管理着从整个组织的资金流动到分配给利益相关者或流程的任务的一切，具体要取决于 DAO 的结构。
跟传统组织相比，DAO 的附加价值在于它的透明度、可访问性以及在很多情况下的自动化决策。由于区块链上的管理规则是透明的，人人都可以浏览任务以及对任务的奖励，检查财务状况并了解相关激励措施。由于 DAO 往往是全球性的，所以跟现有组织相比，DAO 不受边境管制的限制，进入门槛比较低，转换成本也很低。如果一个 DAO 不能满足成员的需求，或者发展得太慢，成员可以迅速解散并组建/加入其他组织。最后，由于 DAO 本质上是基于规则的，所以是朝着 AI 驱动型组织迈出的一步。当然，这是好事还是坏事还有争议，但直接的好处是硬编码的公正性。
加密货币炒作得太厉害，很多说客试图让你相信这是一种“包治百病”的资产。但其实它甚至根本就不是单一资产。我预计，以太坊、比特币等的定义会慢慢分离，发展出各自的用例。定义范围会缩小，用例会出现，支撑炒作的技术会脱颖而出。在此之前，希望对区块链在现实世界当中的应用的检视能被证明是有用的。在此过程中，以太坊平台上的三项领先技术是 DeFi、NFT 与 DAO。这三者的采用都在增多，而且都建立在一个会不断突破自身能力极限的平台上——如果这种采用继续下去的话。
### 现实世界
以太坊 1.0 的主要问题是 gas 费（交易成本）太高、交易时长太慢（完成交易所需的时间），以及交易吞吐量太低（每秒交易量）。任何扩展的尝试都需要在可扩性、保持安全以及去中心化三者之间做出权衡——也就是所谓的可扩性三难困境。
为了跟中心化的替代选择竞争，以太坊至少需要一样的快、一样的便宜，并且能够处理尽可能多的数据。在成本/交易规模方面以太坊已经在跟现有的支付提供商展开竞争了。不过，在成本/字节方面以太坊还没法跟非金融网络提供商和软件公司（如 CDN 和云提供商）竞争。去中心化的数据库的每交易成本本来就要比中心化的替代选择要高，因为需要变更/维护的账簿状态所在的“地方”数量更大。如果交易费用只占总交易的一小部分的话，问题还不大。但是连续地跑复杂的智能合约的成本非常高，因为这种情况下交易的是数据（而不是金钱）。
由于 DeFi 建立在可组合性与互操作性（“货币积木”）的理念之上，所以扩展解决方案不会抑制这些属性带来的创新就显得尤为关键。有两种主要的扩展方式：一是改进 Layer 1（Ethereum 2.0），二是建立 Layer 2（如 zk-rollups）。
目前，Ethereum 1.0 要落后于几个更中心化的 Layer 1（开发 dApp 的基础协议）解决方案。不过，Eth 2.0 可能会胜过它们当中的很多，而且一旦添加 Layer 2（L2）扩展解决方案进来时，那些开发不到位的链将很难在不牺牲去中心化或互操作性的情况下跟以太坊竞争。
需要注意的是，尽管比特币和以太坊可能会存在很长一段时间（前者作为货币，后者作为平台），但区块链的未来很可能是多链的。Solana 和 Polygon 等协议已经为不同的链搭建起关键的“桥梁”。这对整个生态体系，尤其是对于以太坊来说都是极好的。
以太坊可集成的替代品越多， gas 费就可以降得越低，吞吐量增加得越多。从而鼓励在那些只有绝对需要时才跟以太坊交互的链上开发 dApp。虽然在短期内这会牺牲 gas 费的收入，但从长远来看，这可以建立起弹性以及对以太坊的关键依赖。如果每个 app 在某个时候都要高跟以太坊接口，哪怕是最低限度的接口，那么新的开发者就别无选择，只能对接，否则就要冒失去互操作性的风险。
以太坊不仅要胜过第一层的竞争对手，还得胜过现实世界的支付系统。作为一种价值转移协议， Etherum 1.0 只比 Visa 或 PayPal 要便宜些。你也可以说它更安全，但对于既有者来说，安全只是系统层面的风险。要想竞争，以太坊需要处理更多的交易，成本和时间大概要降到现在的十分之一，而且必须被大致相等数量的人所接受。随着 Eth 2.0 的推出，在金额超过 25 美元的交易上，以太坊显然是技术赢家。不过，它的网络效应仍严重滞后于支付巨头。
以太坊要想把网络发展到可以跟对手匹敌的规模，不仅要在技术能力方面跟支付处理竞争，而且还要在以下方面进行竞争：
- 用户体验
- 金融系统集成（尤其是跟 Stripe 与 B2B 集成商等的集成）
- 准确预测成本、交易价值、交易时间
- 公众情绪（商户接受度、资产可信度）**欺诈保护、KYC/AML 以及更好的法律保护**。尽管这对采用来说是必要的，但这些元素都是辅助性的，而且可以说在技术优越的基础上建立起来要容易得多。如果按照 Evan McFarland 的说法，“区块链的元目的是成为去中心化的互联网。而做到这一点唯一的办法就是替换掉云”的话，那么以太坊面临的最大挑战将是规模化计算基础设施的提供商。当前约 60% 的以太坊节点都是运行在 AWS 以及 GCP 上，因为完全规模的节点的设置成本对个人用户来说太贵了。此外，大多数设备/浏览器/应用商店都是在 MacOS、Windows 或 Android 上运行的，随着 Facebook、苹果与进军可穿戴设备，它们也会成为家庭物联网领域的领先者。
要想竞争，以太坊需要在计算、存储和互操作性方面击败大型科技公司。在互操作性方面进展顺利。通过分片和 rollup，以太坊也许在 1-2 年内就能拥有计算成本上的竞争力，尽管这在很大程度上仍是推测性的。家庭计算本质上是一种实用程序。在 CDN 提供商与云 IaaS（如阿里云、fastly 或 AWS）之间集中计算的计算成本相对于支付 ETH gas 费用几乎可以忽略不计。对于某些开发者来说，完全去中心化的计算优于需受检查/中心化的计算可能是一个合理的权衡，但如果以太坊希望成为真正的“世界计算机”的话，那就得相应降低计算成本。
在存储方面，跟存储成本几乎可以忽略不计的 CDN 或 AWS 相比（<0.001 美元），以太坊数据存储的历史存储成本达到了大约 1.8 k美元/MB，所以在存储方面的差距更大。这是因为以太坊区块链从来都没打算成为一种存储设施。事实上，让协议对存储更加友好是从未达成共识的提议分叉之一。如果每个人都要存储上链的每一个字节的数据的话，节点的容量要非常庞大才行。这会导致去中心化的价格对于很多节点运营商来说遥不可及——对于价值主张的核心来说，这是站不住脚的。此处的解决方案是将打包的、加密的以及重要的数据存储在链上，其余的放在侧链。这样也是安全的，因为链下数据需要链上数据才能操作，所以仍然是去中心化的。
稍微总结一下可扩性（你现在可能已经忘记了）——当交易需要绝对可验证时，以太坊目前在互操作性和成本/交易方面胜过所有的替代方案。也许未来的扩展能解决这个问题。作为存储平台的以太坊可能永远不会有竞争力。它可能有朝一日会通过将存储外包给侧链来跟对手竞争，但目前这只是推测。
虽然第一层和第二层扩展解决方案可以大幅缩短交易时间、降低 gas 费用并提高吞吐能力，但这也会带来自己的问题。如果没有像 Polygon 这样的可互操作的“L2 桥接”层，L2 解决方案会令流动性碎片化，并在不同的 L2 之间进行交换时产生太多的阻力，从而限制互操作性。
以下是 Vitalik 对可扩展性面临的问题的看法：
“扩展区块链可以尝试两种方法：做出根本性的技术改进以及增加参数。乍看之下，增加参数似乎很有吸引力：如果你用餐巾纸粗略算一下的话，很容易就能让自己相信消费类笔记本电脑每秒就可以处理数千笔交易，不需要 ZK-SNARK 或 rollup 或分片什么的。但不幸的是，因为很多微妙的原因，这种方法存在根本缺陷。运行区块链节点的计算机不可能把 100% 的 CPU 能力都用来验证区块链；因为需要预留很大的安全余量来抵御意外的 DoS 攻击，而且还需要备用能力来处理内存池里面的交易等任务，还有，你不希望在计算机上运行一个节点会导致机器没法同时用于任何其他应用。此外，带宽同样也有开销：10 MB/s 的连接并不意味着一秒钟就能得到 10 MB 的区块！每 12 秒大概得到 1-5M 字节的块还有可能。存储也是一样。提高对运行节点的硬件要求并将节点运行限制给专门的参与者不是解决方案。要想将区块链去中心化，普通用户能够运行节点，并拥有一种运行节点是一种常见活动的文化至关重要。
另一方面，根本性的技术改进是可行的。目前，以太坊的主要瓶颈是存储大小，而无状态与状态到期可以解决这个问题，最多可增加约 3 倍——但不会更多，因为我们希望运行节点要变得比现在更容易。对区块链分片还可以进一步扩大，因为分片区块链里面没有任何一个节点需要处理每一笔交易。但即便是这样，容量仍有限制：随着容量的增加，最小安全用户数量也会增加，而且对链进行归档的成本（以及如果没有人关心归档的话数据丢失的风险）也会上升。但是我们不必太过担心：这些限制已经足够高，高到我们大概每秒可以处理超过 100 万笔交易，同时具备区块链的完全安全性。但是在不牺牲（让区块链如此有价值的）去中心化的情况下，要做到这一点需要付出努力。”
目前，提议的改进第一层的扩展解决方案是 Ethereum 2.0 和 EIP1559。前者会将链分成多个分片，每个分片会由专用节点随机提供服务。通过创建有效协调的新链，可以减少网络拥塞并增加每秒的交易量。
第二种第一层的解决方案 EIP1559 效果没那么直接，不会带来更好的吞吐量或更低的成本，但可以支持更准确的供需定价，并通过算法优化吞吐量的可变费用。这可以让 gas 费用更加确定，并让开发者更好地制定预算——希望也能减少拥堵。
第二层解决方案一般是这样的协议：先收集交易并进行批处理，然后再放上主链。这些包括：
- Rollups，在链下计算，但输出存储在链上。这仍然是去中心化的，因为密码输出（为了让数据有意义必须这个）是存在链上的。这些预计大概可带来 10-100 倍的可扩展性改进。
- State Channels 是参与者在链上“质押”ETH，开辟了一个单独的链下通道，然后可以自由频繁地进行交易。交易完成后，最终数据存储在链上，质押的 ETH 被偿还。
- 侧链（Side Chains）是专门用于跟以太坊互操作，并用“桥”来传输最终数据的其他区块链（技术上属于 L1）。这些的去中心化程度通常没那么强，而且有替代性的共识机制。
- Plasma，这是锚定在以太坊主网上的迷你“子”链，主链可以对其进行检查，看是否存在欺诈。这些链不能促进一般计算，但可用于更基本的、预设性的活动（如代币交换等），从而卸下主网的一些“脏累”活。
综合来看，扩展是很多以太坊开发者的关注焦点，有众多独立项目都在致力于解决这个问题。但距离问题解决还有很长一段路要走，如果以太坊希望把自己的去中心化当作关键，那任何一个解决方案都不会轻易实现。乐观一点的消息是，虽然交易的使用量和容量一直在增加，但每笔交易的成本仍保持相对稳定。果系统无法在不影响价格的情况下容纳这些资金流，机构就会退缩，直到系统可以容纳为止。stETH解决了这个问题。Mario Laul最近写了一篇关于降低DeFi系统性风险的文章。文章很棒，你一定要看看。他的论点的基础是，作为一个社区，DeFi有机会建立起传统金融所没有的那种弹性。
就像早期的保险公司鼓励布置比较密集的房屋采用防火设计一样，开发DeFi协议的各个团队需要意识到“火势蔓延”的可能性。流动性开采所隐含的杠杆就创造了这样的可能性。Eth2.0的流动性不足，再加上相互关联的流动性提供和保证金头寸的自动清算，意味着闪电崩盘可能会对DeFi这样新生的生态体系造成巨大破坏。由于DeFi为区块链的其余部分提供流动性，这可能会影响以太坊的质押率，在整个生态体系中产生涟漪效应。加密货币具有反射性。
一些风险已经有大量介绍的文献。其中大多数相对来说不太可能，但值得注意。仅举几例：
- Eth2.0的推出可能会延迟或升级会出现错误。
- 生态体系的采用可能无法刺激代币价格。在扩充后交易费用可能会过低，因为费用燃烧会对价格产生影响，或者以太坊的高吞吐量、低抽佣率做法可能会让它变成一种公用事业，没法为代币持有者积累足够的价值。
- 扩展可能没法降低费用，尽管这不太可能，因为很多协议对计算成本已经做出了100倍的改进。
- 代码错误始终是个问题。有几个错误会给漏洞利用的机会，或者会导致合同失效。在以太坊里，大家最熟悉的是对DAO的攻击。不过，鉴于对以太坊核心协议进行的审计以及广泛研究，这似乎不太可能。错误更可能发生在L2以及在以太坊之上开发的产品里。
除了这些比较技术性的风险之外，很多非加密货币原生的投资者也提出了自己的担忧。范围涵括了从伦理到博弈论、法律和社会学的种种。这些担心通常是比较微妙、经过深思熟虑的批评，在这篇已经很长的文章里面已经没有空间来讨论所有这些问题了。以下是一些比较常见的：
基尼系数问题。这个问题通常来自媒体，说的是大量比特币/以太坊被少数精英地址所持有。常见的一种反驳观点认为，这是对地址分析的误用。很多地址被故意设为空，很多地址其实代表的是数百万的所有者。对成批地址的纵向研究会更准确些。不过，即便是这样的研究也表明不平等程度异常之高。以太坊情况也类似。
Vitalik最近写了一篇反对滥用基尼系数的好文章（请原谅老师提到Vitalik，但他确实是一位非常出色的沟通者）。文章的精华总结如下：“那么，这有什么问题呢？呃，问题很多，大家写了很多跟基尼系数有关的各种问题的文章。在本文中，我会重点讨论一个问题，我认为这个问题就整个基尼系数而言讨论是不够充分的，但它跟分析互联网社区（如区块链）中的不平等特别相关。基尼系数将两个实际上看起来完全不同的问题结合到一个单一的不平等指数中：受困于缺乏资源和权力集中。”
他的观点是，以太坊社区存在明显的不平等与其说是生活体验，不如说是参与度的一个指标。拥有了大部分价值的人之所以这样，是因为过去5年的时间里他们一直致力于它的建设，而大多数“穷人”实际上只是普通人，过着中产的生活，然后决定押15美元到ETH身上。
对加密货币的另一个常见指责是说它被用来资助非法活动。据推测，这种想法的大部分来自于比特币被用作暗网市场Silk Road的交换媒介。虽然在统计上很容易就能估算出这样的资金使用的占比，但也有其他一些反驳观点。其中一些看法对严重犯罪其实不太感兴趣，而更多关注到以太坊实现的KYC/避税问题。其主要的反驳论证是技术与道德无关。同样的很多事情VPN与瑞士银行也可以做。这些可都是被普遍认为可以为社会增加净价值的机构，跟偶尔的异常用户不可同日而语。此外，法币通道、IP地址绑定以及区块链的公开性都意味着匿名性并非绝对，起诉是完全可能的。
经济方面，一种批评认为，通货紧缩的供应会阻碍代币的使用，因为大家宁愿HODL而不是做交易。以太坊生态体系大部分的情况本文已经讨论到了，所以这个观点稍微理论化一点。其基础是经济上的理解，即HODL文化会导致囤积行为，不能支撑大方、积极的资本或交易。
这场争论其实已经讨论得非常充分了，早在比特币诞生之前就已在经济文献中出现。奥地利经济学家（罗斯巴德、米塞斯等）认为投资比消费更能刺激经济的增长（根据凯恩斯主义者的说法）。大多数经济学家跨过的那条中线是，政府应该在人口层面刺激消费，并在财政或制度层面刺激投资。奥地利学派认为，稳健货币带来的低时间偏好迫使投资者资本配置要更精明，导致投资更审慎，消费减少。对此新古典主义的回应是拉姆齐-卡斯-库普曼斯（Ramsey-Cass-Koopmans）模型。模型通过一个以K（资本）与C（消费）为输入的函数对连续世代的增长进行建模。要考虑的变量越多，函数就越复杂，但重要的是，低贴现率（时间偏好）仍然会让未来现金更值钱，所以是的——大家会多投资，少消费。
这是不是一件好事是奥地利学派和其他经济学派之间争论的焦点。双方都提出了令人信服的论点，如果本文以这样或那样的方式影响到你的话，那只是因为你没有从对方那里听到足够多的信息。我们从来都没有真正生活在一个对净通货紧缩货币供应进行自动调整的世界里。也从来没有一种资产能够同时是现金、资本和消耗品。简而言之，没人真正确定它会是什么样的。
最后一条批评更具哲学性：相信世界是为集权而构建或围绕集权发展的，个人主权是反社会的或不道德的。
许多加密现象的一个相当大的吸引力是它的自由主义根源。它宣扬自治、国家独立和自力更生。在技术官僚的嗡嗡声中，有粗犷的个人主义和倾倒茶，建立在牛仔背上的行为的底色。“我们不信任，我们验证”。“比特币解决了这个问题”。这是自我中心运动的新话。意思是，恕我直言。“主权个人”的概念源于JD Davidson和Bill Rees-Mogg 1999年出版的名著。它是普及的书如费里斯“四小时工作，并Ammous”的Bitcoin的标准，而且是一个真正愉快的阅读。
通常，对这一想法的批评似乎来自政治、文化或宗教信仰，即任命政府和中央机构作为更好的决策者和公正的等级制度的顶端。有时这正是它们的来源（罗马书13:1-2）。其候，它们来自深深的宗教信仰，即个人更适合社区而不是独立。
在开始讨论为什么去中心化是解决方案或“比特币解决了这个问题”之前，先想一想由此产生的时代精神。技术在文化上是不可知的。确实，去中心化允许围绕更多本地化节点进行中心化。可分割的主权消除了个体实体的“权力垄断”。加密是为了让绝对之间的滑动标尺工具集权和绝对的分权。像以太坊或比特币这样的平台是开放当地社区的方式，不一定是对主权个人的增压。
无论如何，这实际上是一篇投资论文，所以让我们回到金钱上。
## 估值
正如文章开头所提到那样，目前分析师给出的目标价格从5700美元到150000美元以上不等。跟随Ryan和Vivek的脚步，我大致估算了以太坊基于DCF的估值。
下面简要列出了以太坊的“损益表”。收入增长是通过将以太坊的网络效应扩展到dApp与可交易性，从而增加了应计的交易费用。开支是目前出售的ETH来收回采矿的高昂能源成本。在PoS合并后，网络成本约占销售额的1%，利润率（在这种情况下FCF就是收益）可达99%。
这里的估值把ETH的近似价值拆分为三个要素：**没有增长的“核心业务”、保守的未来增长的预期价值以及以太坊所承载的“现实世界选项”的近似定价**。
关于保守主义的一句话：这是内在估值的粗算——此处忽略了流动引起的价格行为。我还在潜在增长和可选择性的估算中运用了大量的试探法。这是为了在方向上的正确，并将我目前认为应该算的和未计入的分开。模型的价值在于看清输入。
这就是2021财年之后零增长的“核心业务”。贴现率用了保守的15%来替代以太坊的感知风险预测、高风险值以及近似的WACC（加权平均资本成本）。假设ETH发行量为1.77亿，则核心业务的价值为300美元/ETH。如果我们把贴现率分别降低到10%和5%，该值会变为383美元和500美元。看起来ETH目前大部分的估值都来自预期的增长。
在判断增长时，可将其分解为以太坊可能会颠覆的行业，假设它占据了每一个市场的5%，并为这种可能性分配一个概率，就可以得出未来增长潜力的预期值。这不是确切的估值，实际上甚至跟估值都不接近，但可以帮助把市场放在合适的背景下。行业之间有可能存在相当大的重叠，而且甚至拿到5%的份额所必需的路径依赖可能意味着结果比我在下面建模出来的要更加的二元化。
如果以太坊不能拿下其中任何一个市场的5%，就有可能在未来十年内逐渐消失。它会碰到一个吸收屏障。加上复杂的适配性意味着一个板块的采用（支付）会强烈影响到另一个（汇款）。反之，如果它在其中一个市场拿下的份额>5%，最后所捕获的价值就有可能远远超过我在下面的粗算。
保守一点，假设ETH交易的销售倍数为1倍，行业之间没有重叠（显然有），并且这些行业在以太坊捕捉时都没有增长，最后得出的价值为1945美元/ETH。现在的总数是2245美元/ETH。这大概就是它今天的交易价格。但“右尾”的结果会如何呢？我们还没有真正考虑过以太坊大部分的登月潜力。好吧，我们可以用可恶的布莱克-斯科尔斯期权定价模型来估算现实世界期权的价格，但我们必须用一些假设来遏制这种估算。
理想情况下，把这个应用到现实世界的期权时，你希望把项目的增量资本支出成本估算为股票价格，并将项目的EV估算为执行价格。这个想法来自Mau boussin 1999年的白皮书。他想出了一个很好的公式，我试着运用到以太坊上。
假设未来10年以太坊有部分的登月潜力，根据上述假设，以太坊嵌入的可选择性可粗略估计为2297美元/ETH。如此估值就可达到4542美元/ETH。加上未来十年预计有2%的通货紧缩供应消耗，ETH的内在价值目前可达5448美元/ETH。
**从理论上讲，用约2234美元/ETH的价格购买以太币买的是核心业务，预期的是以太坊最多有15%的机会占领它正在颠覆的所有市场的5%的份额。用这个价位买入的话，你就是免费获得了可选择性。**
## 零星想法
最后，我会贴出某些我所敬佩之人的零星想法。
“押注以太坊有点像把宝押在一支初创企业管理团队身上，你赌的是开发者将对基础层进行大规模的改造，并成功保持着自己相对于竞争对手主导性的网络效应。”——Lyn Alden（2021）
“你会意识到区块链其实就是一种一般机制，用来运行程序、存储数据以及可验证地执行交易。区块链是计算所存在的一切的超集。我们最终会把它看作是分布式的计算机，但运行速度要比我们的桌面计算机快10亿倍，因为它是把每个人的计算机凑到一起。”——Tim Sweeney（2017）
“跟开源软件开发一样伟大，愿意为金钱而不是免费做事情的人多得多，可以做的事情多得多，突然间，所有这些事情都变得可能，甚至很容易做了。同样地，这个的影响需要30年的时间才能干完，但对于人的工作方式以及获取报酬方式来说，这可能是文明级的转变，这么评价并不疯狂。”——马克·安德森（2021）

[ARTICLE 2: 以太坊（Ethereum ）:下一代智能合约和去中心化应用平台]
当中本聪在2009年1月启动比特币区块链时，他同时向世界引入了两种未经测试的革命性的新概念。第一种就是比特币，一种去中心化的点对点的网上货币，在没有任何资产担保、内在价值或者中心发行者的情况下维持着价值。到目前为止，比特币已经吸引了大量的公众注意力，就政治方面而言它是一种没有中央银行的货币并且有着剧烈的价格波动。然而，中本聪的伟大试验还有与比特币同等重要的一部分：基于工作量证明的区块链概念使得人们可以就交易顺序达成共识。作为应用的比特币可以被描述为一个先申请（first-to-file）系统：如果某人有50BTC并且同时向A和B发送这50BTC，只有被首先被确认的交易才会生效。没有固有方法可以决定两笔交易哪一
笔先到，这个问题阻碍了去中心化数字货币的发展许多年。中本聪的区块链是第一个可靠的去中心化解决办法。现在，开发者们的注意力开始迅速地转向比特币技术的第二部分，区块链怎样应用于货币以外的领域。  常被提及
的应用包括使用链上数字资产来代表定制货币和金融工具（彩色币），某种基础物理设备的所有权（智能资产），如域名一样的没有可替代性的资产（域名币）以及如去中心化交易所，金融衍生品，点到点赌博和链上身份和信誉
系统等更高级的应用。另一个常被问询的重要领域是“智能合约”- 根据事先任意制订的规则来自动转移数字资产的系统。例如，一个人可能有一个存储合约，形式为“A可以每天最多提现X个币，B每天最多Y个，A和B一起可以随意提取，A可以停掉B的提现权”。这种合约的符合逻辑的扩展就是去中心化自治组织（DAOs）-长期的包含一个组织的资产并把组织的规则编码的智能合约。以太坊的目标就是提供一个带有内置的成熟的图灵完备语言的区块链，用这种语言可以创建合约来编码任意状态转换功能，用户只要简单地用几行代码来实现逻辑，就能够创建以上提及的所有系统以及许多我们还想象不到的的其它系统。
### 历史
去中心化的数字货币概念，正如财产登记这样的替代应用一样，早在几十年以前就被提出来了。1980和1990年代的匿名电子现金协议，大部分是以乔姆盲签技术（Chaumian blinding）为基础的。这些电子现金协议提供具有高度隐私性的货币，但是这些协议都没有流行起来，因为它们都依赖于一个中心化的中介机构。1998年，戴伟（Wei Dai）的b-money首次引入了通过解决计算难题和去中心化共识创造货币的思想，但是该建议并未给出如何实现去中心化共识的具体方法。2005年，芬尼（Hal Finney）引入了“可重复使用的工作量证明机制”（reusable proofs of work）概念，它同时使用b-money的思想和Adam Back提出的计算困难的哈希现金（Hashcash）难题来创造密码学货币。但是，这种概念再次迷失于理想化，因为它依赖于可信任的计算作为后端。
因为货币是一个先申请应用，交易的顺序至关重要，所以去中心化的货币需要找到实现去中心化共识的方法。比特币以前的所有电子货币协议所遇到的主要障碍是，尽管对如何创建安全的拜占庭问题容错（Byzantine-fault-tolerant）多方共识系统的
研究已经历时多年，但是上述协议只解决了问题的一半。这些协议假设系统的所有参与者是已知的，并产生如“如果有N方参与到系统中，那么系统可以容忍N/4的恶意参与者”这样形式的安全边界。然而这个假设的问题在于，在匿名的情况下，系统设置的安全边界容易遭受女巫攻击，因为一个攻击者可以在一台服务器或者僵尸网络上创建数以千计的节点，从而单方面确保拥有多数份额。
中本聪的创新是引入这样一个理念：将一个非常简单的基于节点的去中心化共识协议与工作量证明机制结合在一起。节点通过工作量证明机制获得参与到系统的权利，每十分钟将交易打包到“区块”中，从而创建出不断增长的区块链。拥有大量算力的节点有更大的影响力，但获得比整个网络更多的算力比创建一百万个节点困难得多。尽管比特币区块链模型非常简陋，但是实践证明它已经足够好用了，在未来五年，它将成为全世界两百个以上的货币和协议的基石。
### 作为状态转换系统的比特币
从技术角度讲，比特币账本可以被认为是一个状态转换系统，该系统包括所有现存的比特币所有权状态和“状态转换函数”。状态转换函数以当前状态和交易为输入，输出新的状态。例如，在标准的银行系统中，状态就是一个资产负债表，一个从A账户向B账户转账X美元的请求是一笔交易，状态转换函数将从A账户中减去X美元，向B账户增加X美元。如果A账户的余额小于X美元，状态转换函数就会返回错误提示。所以我们可以如下定义状态转换函数：
```
APPLY(S,TX) -> S' or ERROR
```
在上面提到的银行系统中，状态转换函数如下：
```
APPLY({ Alice: $50, Bob: $50 }, "send $20 from Alice to Bob") = { Alice: $30, Bob: $70 }
```
但是：
```
APPLY({ Alice: $50, Bob: $50 }, "send $70 from Alice to Bob") = ERROR
```
比特币系统的“状态”是所有已经被挖出的、没有花费的比特币（技术上称为“未花费的交易输出，unspent transaction outputs 或UTXO”）的集合。每个UTXO都有一个面值和所有者（由20个字节的本质上是密码学公钥的地址所定义\[1\]）。一笔交易包括一个或多个输入和一个或多个输出。每个输入包含一个对现有UTXO的引用和由与所有者地址相对应的私钥创建的密码学签名。每个输出包含一个新的加入到状态中的UTXO。
在比特币系统中，状态转换函数`APPLY(S,TX)->S’`大体上可以如下定义：
1. 交易的每个输入：
* 如果引用的UTXO不存在于现在的状态中（`S`），返回错误提示
* 如果签名与UTXO所有者的签名不一致，返回错误提示
2. 如果所有的UTXO输入面值总额小于所有的UTXO输出面值总额，返回错误提示
3. 返回新状态`S’`，新状态`S’`中移除了所有的输入UTXO，增加了所有的输出UTXO。
第一步的第一部分防止交易的发送者花费不存在的比特币，第二部分防止交易的发送者花费其他人的比特币。第二步确保价值守恒。比特币的支付协议如下。假设Alice想给Bob发送11.7BTC。事实上，Alice不可能正好有11.7BTC。假设她能得到的最小数额比特币的方式是：6+4+2=12。所以，她可以创建一笔有3个输入，2个输出的交易。第一个输出的面值是11.7BTC，所有者是Bob（Bob的比特币地址），第二个输出的面值是0.3BTC，所有者是Alice自己，也就是找零。
### 挖矿
如果我们拥有可信任的中心化服务机构，状态转换系统可以很容易地实现，可以简单地将上述功能准确编码。然而，我们想把比特币系统建立为去中心化的货币系统，为了确保每个人都同意交易的顺序，我们需要将状态转换系统与一个共识系统结合起来。比特币的去中心化共识进程要求网络中的节点不断尝试将交易打包成“区块”。网络被设计为大约每十分钟产生一个区块，每个区块包含一个时间戳、一个随机数、一个对上一个区块的引用（即哈希）和上一区块生成以来发生的所有交易列表。这样随着时间流逝就创建出了一个持续增长的区块链，它不断地更新，从而能够代表比特币账本的最新状态。
依照这个范式，检查一个区块是否有效的算法如下：
1. 检查区块引用的上一个区块是否存在且有效。
2. 检查区块的时间戳是否晚于以前的区块的时间戳，而且早于未来2小时\[2\]。
3. 检查区块的工作量证明是否有效。
4. 将上一个区块的最终状态赋于`S[0]`。
5. 假设TX是区块的交易列表，包含n笔交易。对于属于0……n-1的所有i,进行状态转换`S[i+1] = APPLY(S[i],TX[i])`。如果任何一笔交易i在状态转换中出错，退出程序，返回错误。
6. 返回正确，状态`S[n]`是这一区块的最终状态。
本质上，区块中的每笔交易必须提供一个正确的状态转换。要注意的是，“状态”并不是编码到区块的。它纯粹只是被校验节点记住的抽象概念，对于任意区块都可以从创世状态开始，按顺序加上每一个区块的每一笔交易，（妥妥地）计算出当前的状态。另外，需要注意矿工将交易收录进区块的顺序。如果一个区块中有A、B两笔交易，B花费的是A创建的UTXO，如果A在B以前，这个区块是有效的，否则，这个区块是无效的。
区块验证算法的有趣部分是“工作量证明”概念：对每个区块进行SHA256哈希处理，将得到的哈希视为长度为256比特的数值，该数值必须小于不断动态调整的目标数值，本书写作时目标数值大约是2^190。工作量证明的目的是使区块的创建变得困难，从而阻止女巫攻击者恶意重新生成区块链。因为SHA256是完全不可预测的伪随机函数，创建有效区块的唯一方法就是简单地不断试错，不断地增加随机数的数值，查看新的哈希数值是否小于目标数值。如果当前的目标数值是2^192，就意味着平均需要尝试2^64次才能生成有效的区块。一般而言，比特币网络每隔2016个区块重新设定目标数值，保证平均每十分钟生成一个区块。为了对矿工的计算工作进行奖励，每一个成功生成区块的矿工有权在区块中包含一笔凭空发给他们自己的25BTC的交易。另外，如果交易的输入大于输出，差额部分就作为“交易费用”付给矿工。顺便提一下，对矿工的奖励是比特币发行的唯一机制，创世状态中并没有比特币。
为了更好地理解挖矿的目的，让我们分析比特币网络出现恶意攻击者时会发生什么。因为比特币的密码学基础是非常安全的，所以攻击者会选择攻击没有被密码学直接保护的部分：交易顺序。攻击者的策略非常简单：
1. 向卖家发送100BTC购买商品（尤其是无需邮寄的电子商品）。
2. 等待直至商品发出。
3. 创建另一笔交易，将相同的100BTC发送给自己的账户。
4. 使比特币网络相信发送给自己账户的交易是最先发出的。
一旦步骤（1）发生，几分钟后矿工将把这笔交易打包到区块，假设是第270000个区块。大约一个小时以后，在此区块后面将会有五个区块，每个区块间接地指向这笔交易，从而确认这笔交易。这时卖家收到货款，并向买家发货。因为我们假设这是数字商品，攻击者可以即时收到货。现在，攻击者创建另一笔交易，将相同的100BTC发送到自己的账户。如果攻击者只是向全网广播这一消息，这一笔交易不会被处理。矿工会运行状态转换函数`APPLY(S,TX)`，发现这笔交易将花费已经不在状态中的UTXO。所以，攻击者会对区块链进行分叉，将第269999个区块作为父区块重新生成第270000个区块，在此区块中用新的交易取代旧的交易。因为区块数据是不同的，这要求重新进行工作量证明。另外，因为攻击者生成的新的第270000个区块有不同的哈希，所以原来的第270001到第270005的区块不指向它，因此原有的区块链和攻击者的新区块是完全分离的。在发生区块链分叉时，区块链长的分支被认为是诚实的区块链，合法的的矿工将会沿着原有的第270005区块后挖矿，只有攻击者一人在新的第270000区块后挖矿。攻击者为了使得他的区块链最长，他需要拥有比除了他以外的全网更多的算力来追赶（即51%攻击）。
### 默克尔树
图1：仅提供默克尔树（Merkle tree）上的少量节点已经足够给出分支的合法证明。
图2：任何对于默克尔树的任何部分进行改变的尝试都会最终导致链上某处的不一致。扩展特性是：它的交易存储在多层次的数据结构中。一个区块的哈希实际上只是区块头的哈希，区块头是包含时间戳、随机数、上个区块哈希和存储了所有的区块交易的默克尔树的根哈希的长度大约为200字节的一段数据。默克尔树是一种二叉树，由一组叶节点、一组中间节点和一个根节点构成。最下面的大量的叶节点包含基础数据，每个中间节点是它的两个子节点的哈希，根节点也是由它的两个子节点的哈希，代表了默克尔树的顶部。默克尔树的目的是允许区块的数据可以零散地传送：节点可以从一个源下载区块头，从另外的源下载与其有关的树的其它部分，而依然能够确认所有的数据都是正确的。之所以如此是因为哈希向上的扩散：如果一个恶意用户尝试在树的下部加入一个伪造的交易，所引起的改动将导致树的上层节点的改动，以及更上层节点的改动，最终导致根节点的改动以及区块哈希的改动，这样协议就会将其记录为一个完全不同的区块（几乎可以肯定是带着不正确的工作量证明的）。默克尔树协议对比特币的长期持续性可以说是至关重要的。在2014年4月，比特币网络中的一个全节点-存储和处理所有区块的全部数据的节点-需要占用15GB的存储空间，而且还以每个月超过1GB的速度增长。目前，这一存储空间对台式计算机来说尚可接受，但是手机已经负载不了如此巨大的数据了。未来只有商业机构和爱好者才会充当完整节点。简化支付确认（SPV)协议允许另一种节点存在，这样的节点被成为“轻节点”，它下载区块头，使用区块头确认工作量证明，然后只下载与其交易相关的默克尔树“分支”。这使得轻节点只要下载整个区块链的一小部分就可以安全地确定任何一笔比特币交易的状态和账户的当前余额。### 其它的区块链应用将区块链的思想应用到其它领域的想法早就出现了。在2005年，尼克萨博提出了“用所有权为财产冠名”的概念，文中描述了复制数据库技术的发展如何使基于区块链的系统可以应用于登记土地所有权，创建包括例如房产权、违法侵占和乔治亚州土地税等概念的详细框架。然而，不幸的是在那时还没有实用的复制数据库系统，所以这个协议没有被付诸实践。不过，自从2009年比特币系统的去中心化共识开发成功以来，许多区块链的其它应用开始快速出现。* **域名币（namecoin）**\- 创建于2010年，被称为去中心化的名称注册数据库。像Tor、Bitcoin和BitMessage这样的去中心化协议，需要一些确认账户的方法，这样其他人才能够与用户进行交互。但是，在所有的现存的解决方案中仅有的可用的身份标识是象`1LW79wp5ZBqaHW1jL5TciBCrhQYtHagUWy`这样的伪随机哈希。理想的情况下，人们希望拥有一个带有象“george”这样的名称的账户。然而，问题是如果有人可以创建“george”账户，那么其他人同样也可以创建“george”账户来假扮。唯一的解决方法是先申请原则（first-to-file），只有第一个注册者可以成功注册，第二个不能再次注册同一个账户。这一问题就可以利用比特币的共识协议。域名币是利用区块链实现名称注册系统的最早的、最成功的系统。* **彩色币（Colored coins）**\- 彩色币的目的是为人们在比特币区块链上创建自己的数字货币，或者，在更重要的一般意义上的货币 – 数字令牌提供服务。依照彩色币协议，人们可以通过为某一特别的比特币UTXO指定颜色，发行新的货币。该协议递归地将其它UTXO定义为与交易输入UTXO相同的颜色。这就允许用户保持只包含某一特定颜色的UTXO，发送这些UTXO就像发送普通的比特币一样，通过回溯全部的区块链判断收到的UTXO颜色。* **元币（Metacoins）**\- 元币的理念是在比特币区块链上创建新的协议，利用比特币的交易保存元币的交易，但是采用了不同的状态转换函数APPLY’。因为元币协议不能阻止比特币区块链上的无效的元币交易，所以增加一个规则如果APPLY'(S,TX)返回错误，这一协议将默认APPLY'(S,TX) = S。这为创建任意的、先进的不能在比特币系统中实现的密码学货币协议提供了一个简单的解决方法，而且开发成本非常低，因为挖矿和网络的问题已经由比特币协议处理好了。因此，一般而言，建立共识协议有两种方法：建立一个独立的网络和在比特币网络上建立协议。虽然像域名币这样的应用使用第一种方法已经获得了成功，但是该方法的实施非常困难，因为每一个应用需要创建独立的区块链和建立、测试所有状态转换和网络代码。另外，我们预测去中心化共识技术的应用将会服从幂律分布，大多数的应用太小不足以保证自由区块链的安全，我们还注意到大量的去中心化应用，尤其是去中心化自治组织，需要进行应用之间的交互。另一方面，基于比特币的方法存在缺点，它没有继承比特币可以进行简化确认支付（SPV) 的特性。比特币可以实现简化确认支付，因为比特币可以将区块链深度作为有效性确认代理。在某一点上，一旦一笔交易的祖先们距离现在足够远时，就可以认为它们是合法状态的一部分。与之相反，基于比特币区块链的元币协议不能强迫区块链不包括不符合元币协议的交易。因此，安全的元币协议的简化支付确认需要后向扫描所有的区块，直到区块链的初始点，以确认某一交易是否有效。目前，所有基于比特币的元币协议的“轻”实施都依赖可信任的服务器提供数据，这对主要目的之一是消除信任需要的密码学货币而言，只是一个相当次优的结果。### 脚本即使不对比特币协议进行扩展，它也能在一定程度上实现”智能合约”。比特币的UTXO可以不只被一个公钥拥有，也可以被用基于堆栈的编程语言所编写的更加复杂的脚本所拥有。在这一模式下，花费这样的UTXO，必须提供满足脚本的数据。事实上，基本的公钥所有权机制也是通过脚本实现的：脚本将椭圆曲线签名作为输入，验证交易和拥有这一UTXO的地址，如果验证成功，返回1，否则返回0。更加复杂的脚本用于其它不同的应用情况。例如，人们可以创建要求集齐三把私钥中的两把才能进行交易确认的脚本（多重签名），对公司账户、储蓄账户和某些商业代理来说，这种脚本是非常有用的。脚本也能用来对解决计算问题的用户发送奖励。人们甚至可以创建这样的脚本“如果你能够提供你已经发送一定数额的的狗币给我的简化确认支付证明，这一比特币UTXO就是你的了”，本质上，比特币系统允许不同的密码学货币进行去中心化的兑换。然而，比特币系统的脚本语言存在一些严重的限制：* **缺少图灵完备性** – 这就是说，尽管比特币脚本语言可以支持多种计算，但是它不能支持所有的计算。最主要的缺失是循环语句。不支持循环语句的目的是避免交易确认时出现无限循环。理论上，对于脚本程序员来说，这是可以克服的障碍，因为任何循环都可以用多次重复if 语句的方式来模拟，但是这样做会导致脚本空间利用上的低效率，例如，实施一个替代的椭圆曲线签名算法可能将需要256次重复的乘法，而每次都需要单独编码。* **价值盲（Value-blindness）**。UTXO脚本不能为账户的取款额度提供精细的控制。例如，预言机合约（oracle contract）的一个强大应用是对冲合约，A和B各自向对冲合约中发送价值1000美元的比特币，30天以后，脚本向A发送价值1000美元的比特币，向B发送剩余的比特币。虽然实现对冲合约需要一个预言机（oracle）决定一比特币值多少美元，但是与现在完全中心化的解决方案相比，这一机制已经在减少信任和基础设施方面有了巨大的进步。然而，因为UTXO是不可分割的，为实现此合约，唯一的方法是非常低效地采用许多有不同面值的UTXO（例如对应于最大为30的每个k，有一个2^k的UTXO)并使预言机挑出正确的UTXO发送给A和B。* **缺少状态** – UTXO只能是已花费或者未花费状态，这就没有给需要任何其它内部状态的多阶段合约或者脚本留出生存空间。这使得实现多阶段期权合约、去中心化的交换要约或者两阶段加密承诺协议（对确保计算奖励非常必要）非常困难。这也意味着UTXO只能用于建立简单的、一次性的合约，而不是例如去中心化组织这样的有着更加复杂的状态的合约，使得元协议难以实现。二元状态与价值盲结合在一起意味着另一个重要的应用-取款限额-是不可能实现的。* **区块链盲（Blockchain-blindness）**\- UTXO看不到区块链的数据，例如随机数和上一个区块的哈希。这一缺陷剥夺了脚本语言所拥有的基于随机性的潜在价值，严重地限制了博彩等其它领域应用。我们已经考察了在密码学货币上建立高级应用的三种方法：建立一个新的区块链，在比特币区块链上使用脚本，在比特币区块链上建立元币协议。建立新区块链的方法可以自由地实现任意的特性，成本是开发时间和培育努力。使用脚本的方法非常容易实现和标准化，但是它的能力有限。元币协议尽管非常容易实现，但是存在扩展性差的缺陷。在以太坊系统中，我们的目的是建立一个能够同时具有这三种模式的所有优势的通用框架。### 以太坊以太坊的目的是基于脚本、竞争币和链上元协议（on-chain meta-protocol）概念进行整合和提高，使得开发者能够创建任意的基于共识的、可扩展的、标准化的、特性完备的、易于开发的和协同的应用。以太坊通过建立终极的抽象的基础层-内置有图灵完备编程语言的区块链-使得任何人都能够创建合约和去中心化应用并在其中设立他们自由定义的所有权规则、交易方式和状态转换函数。域名币的主体框架只需要两行代码就可以实现，诸如货币和信誉系统等其它协议只需要不到二十行代码就可以实现。智能合约-包含价值而且只有满足某些条件才能打开的加密箱子-也能在我们的平台上创建，并且因为图灵完备性、价值知晓（value-awareness）、区块链知晓（blockchain-awareness）和多状态所增加的力量而比比特币脚本所能提供的智能合约强大得多。### 以太坊账户在以太坊系统中，状态是由被称为“账户”（每个账户由一个20字节的地址）的对象和在两个账户之间转移价值和信息的状态转换构成的。以太坊的账户包含四个部分：* **随机数**，用于确定每笔交易只能被处理一次的计数器* **账户目前的以太币余额** * **账户的合约代码，如果有的话** * **账户的存储（默认为空）**以太币（Ether）是以太坊内部的主要加密燃料，用于支付交易费用。一般而言，以太坊有两种类型的账户：外部所有的账户（由私钥控制的）和合约账户（由合约代码控制）。外部所有的账户没有代码，人们可以通过创建和签名一笔交易从一个外部账户发送消息。每当合约账户收到一条消息，合约内部的代码就会被激活，允许它对内部存储进行读取和写入，和发送其它消息或者创建合约。### 消息和交易以太坊的消息在某种程度上类似于比特币的交易，但是两者之间存在三点重要的不同。第一，以太坊的消息可以由外部实体或者合约创建，然而比特币的交易只能从外部创建。第二，以太坊消息可以选择包含数据。第三，如果以太坊消息的接受者是合约账户，可以选择进行回应，这意味着以太坊消息也包含函数概念。以太坊中“交易”是指存储从外部账户发出的消息的签名数据包。交易包含消息的接收者、用于确认发送者的签名、以太币账户余额、要发送的数据和两个被称为STARTGAS和GASPRICE的数值。为了防止代码的指数型爆炸和无限循环，每笔交易需要对执行代码所引发的计算步骤-包括初始消息和所有执行中引发的消息-做出限制。STARTGAS就是限制，GASPRICE是每一计算步骤需要支付矿工的费用。如果执行交易的过程中，“用完了瓦斯”，所有的状态改变恢复原状态，但是已经支付的交易费用不可收回了。如果执行交易中止时还剩余瓦斯，那么这些瓦斯将退还给发送者。创建合约有单独的交易类型和相应的消息类型；合约的地址是基于账号随机数和交易数据的哈希计算出来的。消息机制的一个重要后果是以太坊的“头等公民”财产-合约与外部账户拥有同样权以太坊状态转换函数：`APPLY(S,TX) -> S'`，可以定义如下：
1. 检查交易的格式是否正确（即有正确数值）、签名是否有效和随机数是否与发送者账户的随机数匹配。如否，返回错误。
2. 计算交易费用：`fee=STARTGAS * GASPRICE`，并从签名中确定发送者的地址。从发送者的账户中减去交易费用和增加发送者的随机数。如果账户余额不足，返回错误。
3. 设定初值`GAS = STARTGAS`，并根据交易中的字节数减去一定量的瓦斯值。
4. 从发送者的账户转移价值到接收者账户。如果接收账户还不存在，创建此账户。如果接收账户是一个合约，运行合约的代码，直到代码运行结束或者瓦斯用完。
5. 如果因为发送者账户没有足够的钱或者代码执行耗尽瓦斯导致价值转移失败，恢复原来的状态，但是还需要支付交易费用，交易费用加至矿工账户。
6. 否则，将所有剩余的瓦斯归还给发送者，消耗掉的瓦斯作为交易费用发送给矿工。
例如，假设合约的代码如下：
```python
if not self.storage[calldataload(0)]:
self.storage[calldataload(0)] = calldataload(32)
```
需要注意的是，在现实中合约代码是用底层以太坊虚拟机（EVM）代码写成的。上述合约是用高级语言Serpent语言写成的，它可以被编译成EVM代码。假设合约存储器开始时是空的，一个值为10以太，瓦斯为2000，瓦斯价格为0.001以太并且64字节数据，第一个三十二字节的块代表号码2和第二个代表词`CHARLIE`的交易发送后，状态转换函数的处理过程如下：
1. 检查交易是否有效、格式是否正确。
2. 检查交易发送者至少有2000*0.001=2个以太币。如果有，从发送者账户中减去2个以太币。
3. 初始设定gas=2000，假设交易长为170字节，每字节的费用是5，减去850，所以还剩1150。
4. 从发送者账户减去10个以太币，为合约账户增加10个以太币。
5. 运行代码。在这个合约中，运行代码很简单：它检查合约存储器索引为2处是否已使用，注意到它未被使用，然后将其值置为CHARLIE。假设这消耗了187单位的瓦斯，于是剩余的瓦斯为1150 - 187 = 963。
6. 向发送者的账户增加963*0.001=0.963个以太币，返回最终状态。
如果没有合约接收交易，那么所有的交易费用就等于GASPRICE乘以交易的字节长度，交易的数据就与交易费用无关了。另外，需要注意的是，合约发起的消息可以对它们产生的计算分配瓦斯限额，如果子计算的瓦斯用完了，它只恢复到消息发出时的状态。因此，就像交易一样，合约也可以通过对它产生的子计算设置严格的限制，保护它们的计算资源。
### 代码执行
以太坊合约的代码使用低级的基于堆栈的字节码的语言写成的，被称为“以太坊虚拟机代码”或者“EVM代码”。代码由一系列字节构成，每一个字节代表一种操作。一般而言，代码执行是无限循环，程序计数器每增加一（初始值为零）就执行一次操作，直到代码执行完毕或者遇到错误，`STOP`或者`RETURN`指令。操作可以访问三种存储数据的空间：
- **堆栈**，一种后进先出的数据存储，32字节的数值可以入栈，出栈。
- **内存**，可无限扩展的字节队列。
- **合约的长期存储**，一个秘钥/数值的存储，其中秘钥和数值都是32字节大小，与计算结束即重置的堆栈和内存不同，存储内容将长期保持。
代码可以象访问区块头数据一样访问数值，发送者和接收到的消息中的数据，代码还可以返回数据的字节队列作为输出。
EVM代码的正式执行模型令人惊讶地简单。当以太坊虚拟机运行时，它的完整的计算状态可以由元组`(block_state, transaction, message, code, memory, stack, pc, gas)`来定义，这里`block_state`是包含所有账户余额和存储的全局状态。每轮执行时，通过调出代码的第`pc`（程序计数器）个字节，当前指令被找到，每个指令都有定义自己如何影响元组。例如，`ADD`将两个元素出栈并将它们的和入栈，将`gas`（瓦斯）减一并将`pc`加一，`SSTORE`将顶部的两个元素出栈并将第二个元素插入到由第一个元素定义的合约存储位置，同样减少最多200的gas值并将`pc`加一，虽然有许多方法通过即时编译去优化以太坊，但以太坊的基础性的实施可以用几百行代码实现。
### 区块链和挖矿
虽然有一些不同，但以太坊的区块链在很多方面类似于比特币区块链。它们的区块链架构的不同在于，以太坊区块不仅包含交易记录和最近的状态，还包含区块序号和难度值。以太坊中的区块确认算法如下：
1. 检查区块引用的上一个区块是否存在和有效。
2. 检查区块的时间戳是否比引用的上一个区块大，而且小于15分钟。
3. 检查区块序号、难度值、交易根，叔根和瓦斯限额（许多以太坊特有的底层概念）是否有效。
4. 检查区块的工作量证明是否有效。
5. 将`S[0]`赋值为上一个区块的`STATE_ROOT`。
6. 将`TX`赋值为区块的交易列表，一共有`n`笔交易。对于属于`0……n-1`的`i`，进行状态转换`S[i+1] = APPLY(S[i],TX[i])`。如果任何一个转换发生错误，或者程序执行到此处所花费的瓦斯（gas）超过了`GASLIMIT`，返回错误。
7. 用`S[n]`给`S_FINAL`赋值, 向矿工支付区块奖励。
8. 检查`S_FINAL`是否与`STATE_ROOT`相同。如果相同，区块是有效的。否则，区块是无效的。
这一确认方法乍看起来似乎效率很低，因为它需要存储每个区块的所有状态，但是事实上以太坊的确认效率可以与比特币相提并论。原因是状态存储在树结构中（tree structure），每增加一个区块只需要改变树结构的一小部分。因此，一般而言，两个相邻的区块的树结构的大部分应该是相同的，因此存储一次数据，可以利用指针（即子树哈希）引用两次。一种被称为“帕特里夏树”（“Patricia Tree”）的树结构可以实现这一点，其中包括了对默克尔树概念的修改，不仅允许改变节点，而且还可以插入和删除节点。另外，因为所有的状态信息是最后一个区块的一部分，所以没有必要存储全部的区块历史-这一方法如果能够应用到比特币系统中，经计算可以对存储空间有10-20倍的节省。
### 应用
一般来讲，以太坊之上有三种应用。第一类是金融应用，为用户提供更强大的用他们的钱管理和参与合约的方法。包括子货币，金融衍生品，对冲合约，储蓄钱包，遗嘱，甚至一些种类的全面的雇佣合约。第二类是半金融应用，这里有钱的存在但也有很重的非金钱的方面，一个完美的例子是为解决计算问题而设的自我强制悬赏。最后，还有在线投票和去中心化治理这样的完全的非金融应用。
### 令牌系统
链上令牌系统有很多应用，从代表如美元或黄金等资产的子货币到公司股票，单独的令牌代表智能资产，安全的不可伪造的优惠券，甚至与传统价值完全没有联系的用来进行积分奖励的令牌系统。在以太坊中实施令牌系统容易得让人吃惊。关键的一点是理解，所有的货币或者令牌系统，从根本上来说是一个带有如下操作的数据库：从A中减去X单位并把X单位加到B上，前提条件是(1)A在交易之前有至少X单位以及(2)交易被A批准。实施一个令牌系统就是把这样一个逻辑实施到一个合约中去。
用Serpent语言实施一个令牌系统的基本代码如下：
```python
def send(to, value):
if self.storage[from] >= value:
self.storage[from] = self.storage[from] - value
self.storage[to] = self.storage[to] + value
```
这从本质上来说是本文将要进一步描述的“银行系统”状态转变功能的一个最小化实施。需要增加一些额外的代码以提供在初始和其它一些边缘情况下分发货币的功能，理想情况下会增加一个函数让其它合约来查询一个地址的余额。就足够了。理论上，基于以太坊的充当子货币的令牌系统可能包括一个基于比特币的链上元币所缺乏的重要功能：直接用这种货币支付交易费的能力。实现这种能力的方法是在合约里维护一个以太币账户以用来为发送者支付交易费，通过收集被用来充当交易费用的内部货币并把它们在一个不断运行的拍卖中拍卖掉，合约不断为该以太币账户注资。这样用户需要用以太币“激活”他们的账户，但一旦账户中有以太币它将会被重复使用因为每次合约都会为其充值。
### 金融衍生品和价值稳定的货币
金融衍生品是“智能合约”的最普遍的应用，也是最易于用代码实现的之一。实现金融合约的主要挑战是它们中的大部分需要参照一个外部的价格发布器；例如，一个需求非常大的应用是一个用来对冲以太币（或其它密码学货币）相对美元价格波动的智能合约，但该合约需要知道以太币相对美元的价格。最简单地方法是通过由某特定机构（例如纳斯达克）维护的“数据提供“合约进行，该合约的设计使得该机构能够根据需要更新合约，并提供一个接口使得其它合约能够通过发送一个消息给该合约以获取包含价格信息的回复。
当这些关键要素都齐备，对冲合约看起来会是下面的样子：
1. 等待A输入1000以太币。
2. 等待B 输入1000以太币。
3. 通过查询数据提供合约，将1000以太币的美元价值，例如，x美元，记录至存储器。
4. 30天后，允许A或B“重新激活“合约以发送价值x美元的以太币（重新查询数据提供合约以获取新价格并计算）给A并将剩余的以太币发送给B。
这样的合约在密码学商务中有非同寻常的潜力。密码学货币经常被诟病的一个问题就是其价格的波动性；虽然大量的用户和商家可能需要密码学资产所带来的安全和便利，可他们不太会乐意面对一天中资产跌去23%价值的情形。直到现在，最为常见的推荐方案是发行者背书资产；思想是发行者创建一种子货币，对此种子货币他们有权发行和赎回，给予（线下）提供给他们一个单位特定相关资产（例如黄金，美元）的人一个单位子货币。发行者承诺当任何人送还一个单位密码学资产时，发还一个单位的相关资产。这种机制能够使任何非密码学资产被“升级“为密码学资产，如果发行者值得信任的话。
然而实践中发行者并非总是值得信任的，并且一些情况下银行体系太脆弱，或者不够诚实守信从而使这样的服务无法存在。金融衍生品提供了一种替代方案。这里将不再有提供储备以支撑一种资产的单独的发行者，取而代之的是一个由赌一种密码学资产的价格会上升的投机者构成的去中心化市场。与发行者不同，投机者一方没有讨价还价的权利，因为对冲合约把他们的储备冻结在了契约中。注意这种方法并非是完全去中心化的，因为依然需要一个可信任的提供价格信息的数据源，尽管依然有争议这依然是在降低基础设施需求（与发行者不同，一个价格发布器不需要牌照并且似乎可归为自由言论一类）和降低潜在欺诈风险方面的一个巨大的进步。
### 身份和信誉系统
最早的替代币，域名币，尝试使用一个类比特币区块链来提供一个名称注册系统，在那里用户可以将他们的名称和其它数据与特定的密钥关联起来。这种方法允许用户创建一个去中心化的身份，这个身份可以被用于验证和授权。在以太坊中，身份和信誉系统可以通过智能合约来实现，这些合约可以管理用户的声誉和信用评分。用户可以积累声誉分数，这些分数可以在未来的交易中用作信任度的参考，从而增强系统的可信度和可靠性。
智能合约还可以用于创建去中心化的信誉系统，这些系统可以自动记录和验证用户的活动，确保用户行为的透明性和公正性。例如，一个去中心化的信誉系统可以记录用户的交易历史和交互记录，从而帮助其他用户评估交易对方的可信度。这种系统不仅可以提高交易的安全性，还可以减少欺诈行为的发生，增强整个网络的信任度。
此外，以太坊上的智能合约还可以用于创建去中心化的身份验证系统，这些系统可以提供安全的身份验证服务，无需依赖传统的中央权威机构。通过智能合约，用户可以创建和管理自己的数字身份，这些身份可以被用于各种场景，如电子商务、金融服务和个人认证。这种方式不仅可以提高安全性，还可以减少对传统中介机构的依赖，从而促进更加开放和公平的数字经济环境。### 去中心化存储
在过去的几年里出现了一些大众化的在线文件存储初创公司，最突出的是Dropbox，它寻求允许用户上传他们的硬盘备份，提供备份存储服务并允许用户访问从而按月向用户收取费用。然而，在这一点上这个文件存储市场有时相对低效；对现存服务的粗略观察表明，特别地在“神秘谷”20-200GB这一既没有免费空间也没有企业级用户折扣的水平上，主流文件存储成本每月的价格意味着支付在一个月里支付整个硬盘的成本。以太坊合约允许去中心化存储生态的开发，这样用户通过将他们自己的硬盘或未用的网络空间租出去以获得少量收益，从而降低了文件存储的成本。
这样的设施的基础性构件就是我们所谓的“去中心化Dropbox合约”。这个合约工作原理如下。首先，某人将需要上传的数据分成块，对每一块数据加密以保护隐私，并且以此构建一个默克尔树。然后创建一个含以下规则的合约，每N个块，合约将从默克尔树中抽取一个随机索引（使用能够被合约代码访问的上一个块的哈希来提供随机性），然后给第一个实体X以太以支撑一个带有类似简化验证支付（SPV）的在树中特定索引处的块的所有权证明。当一个用户想重新下载他的文件，他可以使用微支付通道协议（例如每32k字节支付1萨博）恢复文件；从费用上讲最高效的方法是支付者不到最后不发布交易，而是用一个略微更合算的带有同样随机数的交易在每32k字节之后来代替原交易。
这个协议的一个重要特征是，虽然看起来象是一个人信任许多不准备丢失文件的随机节点，但是他可以通过秘密分享把文件分成许多小块，然后通过监视合同得知每个小块都还被某个节点的保存着。如果一个合约依然在付款，那么就提供了某个人依然在保存文件的证据。
### 去中心化自治组织
通常意义上“去中心化自治组织（DAO, decentralized autonomous organization）”的概念指的是一个拥有一定数量成员或股东的虚拟实体，依靠比如67%多数来决定花钱以及修改代码。成员会集体决定组织如何分配资金。分配资金的方法可能是悬赏，工资或者更有吸引力的机制比如用内部货币奖励工作。这仅仅使用密码学块链技术就从根本上复制了传统公司或者非营利组织的法律意义以实现强制执行。至此许多围绕DAO的讨论都是围绕一个带有接受分红的股东和可交易的股份的“去中心化自治公司（DAC，decentralized autonomous corporation）”的“资本家”模式；作为替代者，一个被描述为“去中心化自治社区（decentralized autonomous community）”的实体将使所有成员都在决策上拥有同等的权利并且在增减成员时要求67%多数同意。每个人都只能拥有一个成员资格这一规则需要被群体强制实施。
下面是一个如何用代码实现DAO的纲要。最简单地设计就是一段如果三分之二成员同意就可以自我修改的代码。虽然理论上代码是不可更改的，然而通过把代码主干放在一个单独的合约内并且把合约调用的地址指向一个可更改的存储依然可以容易地绕开障碍而使代码变得可修改，在一个这样的DAO合约的简单实现中有三种交易类型，由交易提供的数据区分：
* `[0,i,K,V]` 注册索引为i 的对存储地址索引为K 至 v 的内容的更改建议。
* `[1,i]` 注册对建议i 的投票。
* `[2,i]` 如有足够投票则确认建议i。
然后合约对每一项都有具体的条款。它将维护一个所有开放存储的更改记录以及一个谁投票表决的表。还有一个所有成员的表。当任何存储内容的更改获得了了三分之二多数同意，一个最终的交易将执行这项更改。一个更加复杂的框架会增加内置的选举功能以实现如发送交易，增减成员，甚至提供委任制民主一类的投票代表（即任何人都可以委托另外一个人来代表自己投票，而且这种委托关系是可以传递的，所以如果A委托了B然后B委托了C那么C将决定A的投票）。这种设计将使DAO作为一个去中心化社区有机地成长， 使人们最终能够把挑选合适人选的任务交给专家，与当前系统不同，随着社区成员不断改变他们的站队假以时日专家会容易地出现和消失。
一个替代的模式是去中心化公司，那里任何账户可以拥有0到更多的股份，决策需要三分之二多数的股份同意。一个完整的框架将包括资产管理功能-可以提交买卖股份的订单以及接受这种订单的功能（前提是合约里有订单匹配机制）。代表依然以委任制民主的方式存在，产生了“董事会”的概念。
更先进的组织治理机制可能会在将来实现；现在一个去中心化组织（DO）可以从去中心化自治组织（DAO）开始描述。DO和DAO的区别是模糊的，一个大致的分割线是治理是否可以通过一个类似政治的过程或者一个“自动”过程实现，一个不错的直觉测试是“无通用语言”标准：如果两个成员不说同样的语言组织还能正常运行吗？显然，一个简单的传统的持股式公司会失败，而像比特币协议这样的却很可能成功，罗宾·汉森的“futarchy”，一个通过预测市场实现组织化治理的机制是一个真正的说明“自治”式治理可能是什么样子的好例子。注意一个人无需假设所有DAO比所有DO优越；自治只是一个在一些特定场景下有很大优势的，但在其它地方未必可行的范式，许多半DAO可能存在。
### 进一步的应用
1. **储蓄钱包**。假设Alice想确保她的资金安全，但她担心丢失或者被黑客盗走私钥。她把以太币放到和Bob签订的一个合约里，如下所示，这合同是一个银行：
* Alice单独每天最多可提取1%的资金。
* Bob单独每天最多可提取1%的资金，但Alice可以用她的私钥创建一个交易取消Bob的提现权限。
* Alice 和 Bob 一起可以任意提取资金。一般来讲，每天1%对Alice足够了，如果Alice想提现更多她可以联系Bob寻求帮助。如果Alice的私钥被盗，她可以立即找到Bob把她的资金转移到一个新合同里。如果她弄丢了她的私钥，Bob可以慢慢地把钱提出。如果Bob表现出了恶意，她可以关掉他的提现权限。
2. **作物保险**。一个人可以很容易地以天气情况而不是任何价格指数作为数据输入来创建一个金融衍生品合约。如果一个爱荷华的农民购买了一个基于爱荷华的降雨情况进行反向赔付的金融衍生品，那么如果遇到干旱，该农民将自动地收到赔付资金而如果有足量的降雨他会很开心因为他的作物收成会很好。
3. **一个去中心化的数据发布器**。对于基于差异的金融合约，事实上通过“谢林点”协议将数据发布器去中心化是可能的。谢林点的工作原理如下：N方为某个指定的数据提供输入值到系统（例如ETH/USD价格），所有的值被排序，每个提供25%到75%之间的值的节点都会获得奖励，每个人都有激励去提供他人将提供的答案，大量玩家可以真正同意的答案明显默认就是正确答案，这构造了一个可以在理论上提供很多数值，包括ETH/USD价格，柏林的温度甚至某个特别困难的计算的结果的去中心化协议。
5. **云计算**。EVM技术还可被用来创建一个可验证的计算环境，允许用户邀请他人进行计算然后选择性地要求提供在一定的随机选择的检查点上计算被正确完成的证据。这使得创建一个任何用户都可以用自己的台式机，笔记本电脑或者专用服务器参与的云计算市场成为可能，现场检查和安全保证金可以被用来确保系统是值得信任的（即没有节点可以因欺骗获利）。虽然这样一个系统可能并不适用所有任务；例如，需要高级进程间通信的任务就不易在一个大的节点云上完成。然而一些其它的任务就很容易实现并行；SETI@home, folding@home和基因算法这样的项目就很容易在这样的平台上进行。
6. **点对点赌博**。任意数量的点对点赌博协议都可以搬到以太坊的区块链上，例如Frank Stajano和Richard Clayton的Cyberdice。 最简单的赌博协议事实上是这样一个简单的合约，它用来赌下一个区块的哈希值与猜测值之间的差额, 据此可以创建更复杂的赌博协议，以实现近乎零费用和无欺骗的赌博服务。
7. **预测市场**。不管是有神谕还是有谢林币，预测市场都会很容易实现，带有谢林币的预测市场可能会被证明是第一个主流的作为去中心化组织管理协议的“futarchy”应用。
8. **链上去中心化市场，以身份和信誉系统为基础**。
### 改进版幽灵协议的实施
“幽灵”协议（"Greedy Heaviest Observed Subtree" (GHOST) protocol）是由Yonatan Sompolinsky 和 Aviv Zohar在2013年12月引入的创新。幽灵协议提出的动机是当前快速确认的块链因为区块的高作废率而受到低安全性困扰；因为区块需要花一定时间（设为t）扩散至全网，如果矿工A挖出了一个区块然后矿工B碰巧在A的区块扩散至B之前挖出了另外一个区块，矿工B的区块就会作废并且没有对网络安全作出贡献。此外，这里还有中心化问题：如果A是一个拥有全网30%算力的矿池而B拥有10%的算力，A将面临70%的时间都在产生作废区块的风险而B在90%的时间里都在产生作废区块。因此，如果作废率高，A将简单地因为更高的算力份额而更有效率，综合这两个因素，区块产生速度快的块链很可能导致一个矿池拥有实际上能够控制挖矿过程的算力份额。
正如Sompolinsky 和 Zohar所描述的，通过在计算哪条链“最长”的时候把废区块也包含进来，幽灵协议解决了降低网络安全性的第一个问题；这就是说，不仅一个区块的父区块和更早的祖先块，祖先块的作废的后代区块（以太坊术语中称之为“叔区块”）也被加进来以计算哪一个区块拥有支持其的最大工作量证明。我们超越了Sompolinsky 和 Zohar所描述的协议以解决第二个问题 – 中心化倾向，以太坊付给以“叔区块”身份为新块确认作出贡献的废区块87.5%的奖励，把它们纳入计算的“侄子区块”将获得奖励的12.5%，不过，交易费用不奖励给叔区块。
以太坊实施了一个只下探到第五层的简化版本的幽灵协议。其特点是，废区块只能以叔区块的身份被其父母的第二代至第五代后辈区块，而不是更远关系的后辈区块（例如父母区块的第六代后辈区块，或祖父区块的第三代后辈区块）纳入计算。这样做有几个原因。首先，无条件的幽灵协议将给计算给定区块的哪一个叔区块合法带来过多的复杂性。其次，带有以太坊所使用的补偿的无条件的幽灵协议剥夺了矿工在主链而不是一个公开攻击者的链上挖矿的激励。最后，计算表明带有激励的五层幽灵协议即使在出块时间为15s的情况下也实现了了95%以上的效率，而拥有25%算力的矿工从中心化得到的益处小于3%。
### 费用
因为每个发布的到区块链的交易都占用了下载和验证的成本，需要有一个包括交易费的规范机制来防范滥发交易。比特币使用的默认方法是纯自愿的交易费用，依靠矿工担当守门人并设定动态的最低费用。因为这种方法是“基于市场的”，使得矿工和交易发送者能够按供需来决定价格，所以这种方法在比特币社区中得到了广泛应用。### 计算和图灵完备
需要强调的是以太坊虚拟机是图灵完备的；这意味着EVM代码可以实现任何可以想象的计算，包括无限循环。EVM代码有两种方式实现循环。首先，JUMP指令可以让程序跳回至代码前面某处，还有允许如 `while x < 27: x = x * 2` 一样的条件语句的JUMPI指令实现条件跳转。其次，合约可以调用其它合约，有通过递归实现循环的潜力。这很自然地导致了一个问题：恶意用户能够通过迫使矿工和全节点进入无限循环而不得不关机吗？
这问题出现是因为计算机科学中一个叫停机问题的问题：一般意义上没有办法知道，一个给定的程序是否能在有限的时间内结束运行。正如在状态转换章节所述，我们的方案通过为每一个交易设定运行执行的最大计算步数来解决问题，如果超过则计算被恢复原状但依然要支付费用。消息以同样的方式工作。为显示这一方案背后的动机，请考虑下面的例子：
* 一个攻击者创建了一个运行无限循环的合约，然后发送了一个激活循环的交易给矿工，矿工将处理交易，运行无限循环直到瓦斯耗尽。即使瓦斯耗尽交易半途停止，交易依然正确（回到原处）并且矿工依然从攻击者那里挣到了每一步计算的费用。
* 一个攻击者创建一个非常长的无限循环意图迫使矿工长时间内一直计算致使在计算结束前若干区块已经产生于是矿工无法收录交易以赚取费用。然而，攻击者需要发布一个 STARTGAS 值以限制可执行步数，因而矿工将提前知道计算将耗费过多的步数。
* 一个攻击者看到一个包含诸如 `send(A,self.storage); self.storage = 0` 格式的合约然后发送带有只够执行第一步的费用而不够执行第二步的交易（即提现但不减少账户余额）。合约作者无需担心防卫类似攻击，因为如果执行中途停止则所有变更都被回复。
* 一个金融合约靠提取九个专用数据发布器的中值来工作以最小化风险，一个攻击者接管了其中一个数据提供器，然后把这个按DAO章节所述的可变地址调用机制设计成可更改的数据提供器转为运行一个无限循环，以求尝试逼迫任何从此金融合约索要资金的尝试都会因瓦斯耗尽而中止。然而，该金融合约可以在消息里设置瓦斯限制以防范此类问题。
图灵完备的替代是图灵不完备，这里 JUMP 和 JUMPI 指令不存在并且在某个给定时间每个合约只允许有一个拷贝存在于调用堆栈内。在这样的系统里，上述的费用系统和围绕我们的方案的效率的不确定性可能都是不需要的，因为执行一个合约的成本将被它的大小决定。此外，图灵不完备甚至不是一个大的限制，在我们内部设想的所有合约例子中，至今只有一个需要循环，而且即使这循环也可以被26个单行代码段的重复所代替。考虑到图灵完备带来的严重的麻烦和有限的益处，为什么不简单地使用一种图灵不完备语言呢？事实上图灵不完备远非一个简洁的解决方案。为什么？请考虑下面的合约：
```python
C0: call(C1); call(C1);
C1: call(C2); call(C2);
C2: call(C3); call(C3);
...
C49: call(C50); call(C50);
C50: (作一个图灵机的步计算和记录结果在合约的长期存储)
```
现在，发送一个这样的交易给A，这样，在51个交易中，我们有了一个需要花费2^50 步计算的合约，矿工可能尝试通过为每一个合约维护一个最高可执行步数并且对于递归调用其它合约的合约计算可能执行步数从而预先检测这样的逻辑炸弹，但是这会使矿工禁止创建其它合约的合约（因为上面26个合约的创建和执行可以很容易地放入一个单独合约内）。另外一个问题点是一个消息的地址字段是一个变量，所以通常来讲可能甚至无法预先知道一个合约将要调用的另外一个合约是哪一个。于是，最终我们有了一个惊人的结论：图灵完备的管理惊人地容易，而在缺乏同样的控制时图灵不完备的管理惊人地困难——那为什么不让协议图灵完备呢？
### 货币和发行
以太坊网络包含自身的内置货币以太币，以太币扮演双重角色，为各种数字资产交易提供主要的流动性，更重要的是提供了支付交易费用的一种机制。为便利及避免将来的争议期间（参见当前的mBTC/uBTC/聪的争论），不同面值的名称将被提前设置：
* 1: 伟
* 10^12: 萨博
* 10^15: 芬尼
* 10^18: 以太
这应该被当作是“元”和“分”或者“比特币”和“聪”的概念的扩展版，在不远的将来，我们期望“以太”被用作普通交易，“芬尼”用来进行微交易，“萨博”和“伟”用来进行关于费用和协议实施的讨论。
发行模式如下：
* 通过发售活动，以太币将以每BTC 1337-2000以太的价格发售，一个旨在为以太坊组织筹资并且为开发者支付报酬的机制已经在其它一些密码学货币平台上成功使用。早期购买者会享受较大的折扣，发售所得的BTC将完全用来支付开发者和研究者的工资和悬赏，以及投入密码学货币生态系统的项目。
* 0.099x （x为发售总量）将被分配给BTC融资或其它的确定性融资成功之前参与开发的早期贡献者，另外一个0.099x将分配给长期研究项目。
* 自上线时起每年都将有0.26x（x为发售总量）被矿工挖出。
### 发行分解
永久线性增长模型降低了在比特币中出现的财富过于集中的风险，并且给予了活在当下和将来的人公平的机会去获取货币，同时保持了对获取和持有以太币的激励，因为长期来看“货币供应增长率”是趋于零的。我们还推断，随着时间流逝总会发生因为粗心和死亡等原因带来的币的遗失，假设币的遗失是每年货币供应量的一个固定比例，则最终总的流通中的货币供应量会稳定在一个等于年货币发行量除以遗失率的值上（例如，当遗失率为1%时，当供应量达到30x时，每年有0.3x被挖出同时有0.3x丢失，达到一个均衡）。
除了线性的发行方式外，和比特币一样以太币的供应量增长率长期来看也趋于零。
### 挖矿的中心化
比特币挖矿算法基本上是让矿工千万次地轻微改动区块头，直到最终某个节点的改动版本的哈希小于目标值（目前是大约2^190）。然而，这种挖矿算法容易被两种形式的中心化攻击。第一种，挖矿生态系统被专门设计的因而在比特币挖矿这一特殊任务上效率提高上千倍的ASICs（专用集成电路）和电脑芯片控制。这意味着比特币挖矿不再是高度去中心化的和追求平等主义的，而是需要巨额资本的有效参与。第二种，大部分比特币矿工事实上不再在本地完成区块验证；而是依赖中心化的矿池提供区块头。这个问题可以说很严重：在本文写作时，最大的两个矿池间接地控制了大约全网50%的算力，虽然当一个矿池或联合体尝试51%攻击时矿工可以转换到其它矿池这一事实减轻了问题的严重性。
以太坊现在的目的是使用一个基于为每1000个随机数随机产生唯一哈希的函数的挖矿算法，用足够宽的计算域，去除专用硬件的优势。这样的策略当然不会使中心化的收益减少为零，但是也不需要。注意每单个用户使用他们的私人笔记本电脑或台式机就可以几乎免费地完成一定量的挖矿活动，但当到了100%的CPU使用率之后更多地挖矿就会需要他们支付电力和硬件成本。ASIC挖矿公司需要从第一个哈希开始就为电力和硬件支付成本。所以，如果中心化收益能够保持在(E + H) / E 以下，那么即使ASICs被制造出来普通矿工依然有生存空间。另外，我们计划将挖矿算法设计成挖矿需要访问整个区块链，迫使矿工存储完成的区块链或者至少能够验证每笔交易。这去除了对中心化矿池的需要；虽然矿池依然可以扮演平滑收益分配的随机性的角色，但这功能可以被没有中心化控制的P2P矿池完成地同样好。这样即使大部分普通用户依然倾向选择轻客户端，通过增加网络中的全节点数量也有助于抵御中心化。
### 扩展性
扩展性问题是以太坊常被关注的地方，与比特币一样，以太坊也遭受着每个交易都需要网络中的每个节点处理这一困境的折磨。比特币的当前区块链大小约为20GB，以每小时1MB的速度增长。如果比特币网络处理Visa级的2000tps的交易，它将以每三秒1MB的速度增长（1GB每小时，8TB每年）。以太坊可能也会经历相似的甚至更糟的增长模式，因为在以太坊区块链之上还有很多应用，而不是像比特币只是简单的货币，但以太坊全节点只需存储状态而不是完整的区块链历史这一事实让情况得到了改善。
大区块链的问题是中心化风险。如果块链大小增加至比如100TB，可能的场景将是只有非常小数目的大商家会运行全节点，而常规用户使用轻的SPV节点。这会增加对全节点合伙欺诈牟利（例如更改区块奖励，给他们自己BTC）的风险的担忧。轻节点将没有办法立刻检测到这种欺诈。当然，至少可能存在一个诚实的全节点，并且几个小时之后有关诈骗的信息会通过Reddit这样的渠道泄露，但这时已经太晚：任凭普通用户做出怎样的努力去废除已经产生的区块，他们都会遇到与发动一次成功的51%攻击同等规模的巨大的不可行的协调问题。在比特币这里，现在这是一个问题，但Peter Todd建议的一个改动可以缓解这个问题。
近期，以太坊会使用两个附加的策略以应对此问题。首先，因为基于区块链的挖矿算法，至少每个矿工会被迫成为一个全节点，这保证了一定数量的全节点。其次，更重要的是，处理完每笔交易后，我们会把一个中间状态树的根包含进区块链。即使区块验证是中心化的，只要有一个诚实的验证节点存在，中心化的问题就可以通过一一个验证协议避免。如果一个矿工发布了一个不正确的区块，这区块要么是格式错，要么状态S\[n\]是错的。因为S\[0\]是正确的，必然有第一个错误状态S\[i\]但S\[i-1\]是正确的，验证节点将提供索引i，一起提供的还有处理APPLY(S\[i-1\],TX\[i\]) -> S\[i\]所需的帕特里夏树节点的子集。这些节点将受命进行这部分计算，看产生的S\[i\]与先前提供的值是否一致。另外，更复杂的是恶意矿工发布不完整区块进行攻击，造成没有足够的信息去确定区块是否正确。解决方案是质疑-回应协议：验证节点对目标交易索引发起质疑，接收到质疑信息的轻节点会对相应的区块取消信任，直到另外一个矿工或者验证者提供一个帕特里夏节点子集作为正确的证据。
综述：去中心化应用
上述合约机制使得任何一个人能够在一个虚拟机上建立通过全网共识来运行命令行应用（从根本上来说是），它能够更改一个全网可访问的状态作为它的“硬盘”。然而，对于多数人来说，用作交易发送机制的命令行接口缺乏足够的用户友好使得去中心化成为有吸引力的替代方案。最后，一个完整的“去中心化应用”应该包括底层的商业逻辑组件【无论是否在以太坊完整实施，使用以太坊和其它系统组合（如一个P2P消息层，其中一个正在计划放入以太坊客户端）或者仅有其它系统的方式】和上层的图形用户接口组件。以太坊客户端被设计成一个网络浏览器，但包括对“eth” Javascript API对象的支持，可被客户端里看到的特定的网页用来与以太坊区块链交互。从“传统”网页的角度看来，这些网页是完全静态的内容，因为区块链和其它去中心化协议将完全代替服务器来处理用户发起的请求。最后，去中心化协议有希望自己利用某种方式使用以太坊来存储网页。
结论
以太坊协议最初是作为一个通过高度通用的语言提供如链上契约，提现限制和金融合约，赌博市场等高级功能的升级版密码学货币来构思的。以太坊协议将不直接“支持”任何应用，但图灵完备编程语言的存在意味着理论上任意的合约都可以为任何交易类型和应用创建出来。然而关于以太坊更有趣的是，以太坊协议比单纯的货币走得更远，围绕去中心化存储，去中心化计算和去中心化预测市场以及数十个类似概念建立的协议和去中心化应用，有潜力从根本上提升计算行业的效率，并通过首次添加经济层为其它的P2P协议提供有力支撑，最终，同样会有大批与金钱毫无关系的应用出现。
以太坊协议实现的任意状态转换概念提供了一个具有独特潜力的平台；与封闭式的，为诸如数据存储，赌博或金融等单一目的设计的协议不同，以太坊从设计上是开放式的，并且我们相信它极其适合作为基础层服务于在将来的年份里出现的极其大量的金融和非金融协议。
注解与进阶阅读
### 注解
1. 一个有经验的读者会注意到事实上比特币地址是椭圆曲线公钥的哈希，而非公钥本身，然而事实上从密码学术语角度把公钥哈希称为公钥完全合理。这是因为比特币密码学可以被认为是一个定制的数字签名算法，公钥由椭圆曲线公钥的哈希组成，签名由椭圆曲线签名连接的椭圆曲线公钥组成，而验证算法包括用作为公钥提供的椭圆曲线公钥哈希来检查椭圆曲线公钥，以及之后的用椭圆曲线公钥来验证椭圆曲线签名。
2. 技术上来说，前11个区块的中值。
3. 在内部，2和“CHARLIE”都是数字，后一个有巨大的base256编码格式，数字可以从0到2^256-1。
